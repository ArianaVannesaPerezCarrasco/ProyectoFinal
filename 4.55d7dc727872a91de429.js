(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"1gqn":function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"7JUV":function(t,e,n){"use strict";n.r(e),n.d(e,"FarmModule",function(){return qd});var r=n("ofXK"),i=n("tyNb"),o=n("1kSV"),s=n("3Pt+"),u=n("MCLT"),a=n("fXoL"),c=n("D0XW"),h=n("HDdC"),f=n("Cfvw"),l=n("LRne"),p=n("JX91"),d=n("7o/Q");function v(){return t=>t.lift(new y)}class y{call(t,e){return e.subscribe(new g(t))}}class g extends d.a{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}var b=n("lJxs"),m=n("Kqap"),w=n("/uUt"),I=n("pLZG"),O=n("pxpQ"),_=n("spgP"),E=n("Jgta"),T=n("zIRd"),j=n("q/0M"),S=n("qOnz"),N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var x,k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},P=P||{},D=k||self;function C(){}function L(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),V=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function q(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:q).apply(null,arguments)}function z(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function G(){return Date.now()}function H(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,U)&&t[U]||(t[U]=++V)}(this)},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},X=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function J(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Y(t){return/^[\s\xa0]*$/.test(t)}var $,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Z(t,e){return-1!=t.indexOf(e)}function tt(t,e){return t<e?-1:t>e?1:0}t:{var et=D.navigator;if(et){var nt=et.userAgent;if(nt){$=nt;break t}}$=""}function rt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function it(t){var e={};for(var n in t)e[n]=t[n];return e}var ot="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function st(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ot.length;o++)n=ot[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ut(t){return ut[" "](t),t}ut[" "]=C;var at,ct,ht=Z($,"Opera"),ft=Z($,"Trident")||Z($,"MSIE"),lt=Z($,"Edge"),pt=lt||ft,dt=Z($,"Gecko")&&!(Z($.toLowerCase(),"webkit")&&!Z($,"Edge"))&&!(Z($,"Trident")||Z($,"MSIE"))&&!Z($,"Edge"),vt=Z($.toLowerCase(),"webkit")&&!Z($,"Edge");function yt(){var t=D.document;return t?t.documentMode:void 0}t:{var gt="",bt=(ct=$,dt?/rv:([^\);]+)(\)|;)/.exec(ct):lt?/Edge\/([\d\.]+)/.exec(ct):ft?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ct):vt?/WebKit\/(\S+)/.exec(ct):ht?/(?:Version)[ \/]?(\S+)/.exec(ct):void 0);if(bt&&(gt=bt?bt[1]:""),ft){var mt=yt();if(null!=mt&&mt>parseFloat(gt)){at=String(mt);break t}}at=gt}var wt={};function It(t){return function(t,e){var n=wt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=Q(String(at)).split("."),r=Q(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=tt(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||tt(0==s[2].length,0==u[2].length)||tt(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}var Ot=D.document&&ft&&(yt()||parseInt(at,10))||void 0,_t=!ft||9<=Number(Ot),Et=ft&&!It("9"),Tt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",C,e),D.removeEventListener("test",C,e)}catch(n){}return t}();function jt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function St(t,e){if(jt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(dt){t:{try{ut(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}jt.prototype.b=function(){this.defaultPrevented=!0},H(St,jt);var Nt={2:"touch",3:"pen",4:"mouse"};St.prototype.b=function(){St.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var At="closure_listenable_"+(1e6*Math.random()|0),xt=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++xt,this.Y=this.Z=!1}function Pt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=K(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Pt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Lt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),Ut={};function Vt(t,e,n,r,i){if(r&&r.once)return qt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=Jt(n),t&&t[At]?t.va(e,n,R(r)?!!r.capture:!!r,i):Mt(t,e,n,!1,r,i)}function Mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!_t)return null;var u=Kt(t);if(u||(t[Rt]=u=new Dt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Bt,e=_t?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function qt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)qt(t,e[o],n,r,i);return null}return n=Jt(n),t&&t[At]?t.wa(e,n,R(r)?!!r.capture:!!r,i):Mt(t,e,n,!0,r,i)}function Ft(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Ft(t,e[o],n,r,i);else r=R(r)?!!r.capture:!!r,n=Jt(n),t&&t[At]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Lt(o=t.a[e],n,r,i))&&(Pt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Kt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Lt(e,n,r,i)),(n=-1<t?e[t]:null)&&zt(n))}function zt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[At])Ct(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Gt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Kt(e))?(Ct(n,t),0==n.b&&(n.src=null,e[Rt]=null)):Pt(t)}}}function Gt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function Ht(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&zt(t),n.call(r,e)}function Bt(t,e){if(t.Y)return!0;if(!_t){if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ht(t,e=new St(e,this))}return Ht(t,new St(e,this))}function Kt(t){return(t=t[Rt])instanceof Dt?t:null}var Xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jt(t){return"function"==typeof t?t:(t[Xt]||(t[Xt]=function(e){return t.handleEvent(e)}),t[Xt])}function Wt(){B.call(this),this.c=new Dt(this),this.J=this,this.C=null}function Yt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new jt(e,t);else if(e instanceof jt)e.target=e.target||t;else{var i=e;st(e=new jt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=$t(s,r,!0,e)&&i}if(i=$t(s=e.a=t,r,!0,e)&&i,i=$t(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=$t(s=e.a=n[o],r,!1,e)&&i}function $t(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Ct(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}H(Wt,B),Wt.prototype[At]=!0,(x=Wt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},x.removeEventListener=function(t,e,n,r){Ft(this,t,e,n,r)},x.G=function(){if(Wt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Pt(n[r]);delete e.a[t],e.b--}}this.C=null},x.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},x.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Qt=D.JSON.stringify;function Zt(){this.b=this.a=null}var te,ee=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new re},function(t){t.reset()});function ne(){var t=ue,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function re(){this.next=this.b=this.a=null}function ie(t){D.setTimeout(function(){throw t},0)}function oe(t,e){te||function(){var t=D.Promise.resolve(void 0);te=function(){t.then(ae)}}(),se||(te(),se=!0),ue.add(t,e)}Zt.prototype.add=function(t,e){var n=ee.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},re.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},re.prototype.reset=function(){this.next=this.b=this.a=null};var se=!1,ue=new Zt;function ae(){for(var t;t=ne();){try{t.a.call(t.b)}catch(n){ie(n)}var e=ee;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}se=!1}function ce(t,e){Wt.call(this),this.b=t||1,this.a=e||D,this.f=F(this.Za,this),this.g=G()}function he(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function fe(t,e,n){if("function"==typeof t)n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}function le(t){t.a=fe(function(){t.a=null,t.c&&(t.c=!1,le(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}H(ce,Wt),(x=ce.prototype).aa=!1,x.M=null,x.Za=function(){if(this.aa){var t=G()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Yt(this,"tick"),this.aa&&(he(this),this.start()))}},x.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=G())},x.G=function(){ce.X.G.call(this),he(this),delete this.a};var pe=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}N(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:le(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(B);function de(t){B.call(this),this.b=t,this.a={}}H(de,B);var ve=[];function ye(t,e,n,r){Array.isArray(n)||(n&&(ve[0]=n.toString()),n=ve);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ge(t){rt(t.a,function(t,e){this.a.hasOwnProperty(e)&&zt(t)},t),t.a={}}function be(){this.a=!0}function me(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Qt(n)}catch(u){return e}}(t,n)+(r?" "+r:"")})}de.prototype.G=function(){de.X.G.call(this),ge(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},be.prototype.info=function(){};var we={},Ie=null;function Oe(){return Ie=Ie||new Wt}function _e(t){jt.call(this,we.Fa,t)}function Ee(t){var e=Oe();Yt(e,new _e(e,t))}function Te(t,e){jt.call(this,we.STAT_EVENT,t),this.stat=e}function je(t){var e=Oe();Yt(e,new Te(e,t))}function Se(t){jt.call(this,we.Ga,t)}function Ne(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}we.Fa="serverreachability",H(_e,jt),we.STAT_EVENT="statevent",H(Te,jt),we.Ga="timingevent",H(Se,jt);var Ae={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},xe={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ke(){}function Pe(){}ke.prototype.a=null;var De,Ce={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Le(){jt.call(this,"d")}function Re(){jt.call(this,"c")}function Ue(){}function Ve(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new de(this),this.P=Me,this.R=new ce(t=pt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}H(Le,jt),H(Re,jt),H(Ue,ke),De=new Ue;var Me=45e3,qe={},Fe={};function ze(t,e,n){t.H=1,t.i=fn(on(e)),t.j=n,t.I=!0,Ge(t,null)}function Ge(t,e){t.u=G(),Ke(t),t.l=on(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),En(n.b,"t",r),t.D=0,t.a=br(t.g,t.g.C?e:null),0<t.O&&(t.F=new pe(F(t.Ca,t,t.a),t.O)),ye(t.J,t.a,"readystatechange",t.Xa),e=t.B?it(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ee(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function He(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Be(t,n);if(i==Fe){4==e&&(t.h=4,je(14),r=!1),me(t.c,t.f,null,"[Incomplete Response]");break}if(i==qe){t.h=4,je(15),me(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}me(t.c,t.f,i,null),$e(t,i)}4==e&&0==n.length&&(t.h=1,je(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),hr(e),e.F=!0,je(11))):(me(t.c,t.f,n,"[Invalid Chunked Response]"),Ye(t),We(t))}function Be(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Fe:(n=Number(e.substring(n,r)),isNaN(n)?qe:(r+=1)+n>e.length?Fe:(e=e.substr(r,n),t.D=r+n,e))}function Ke(t){t.T=G()+t.P,Xe(t,t.P)}function Xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ne(F(t.Va,t),e)}function Je(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function We(t){0==t.g.v||t.A||pr(t.g,t)}function Ye(t){Je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,he(t.R),ge(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function $e(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||kn(n.b,t)))if(n.I=t.N,!t.C&&kn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(ip){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;lr(n),er(n)}cr(n),je(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Ne(F(n.Sa,n),6e3));if(1>=xn(n.b)&&n.ea){try{n.ea()}catch(ip){}n.ea=void 0}}else vr(n,11)}else if((t.C||n.a==t)&&lr(n),!Y(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(Z(h,"spdy")||Z(h,"quic")||Z(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Pn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,hn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=G()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=gr(a,a.C?a.ga:null,a.fa),p.C){Dn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Je(d),Ke(d)),a.a=p}else ar(a);0<n.g.length&&ir(n)}else"stop"!=i[0]&&"close"!=i[0]||vr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?vr(n,7):tr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Ee(4)}catch(ip){}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)X(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function tn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];en(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)en(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function en(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(x=Ve.prototype).setTimeout=function(t){this.P=t},x.Xa=function(t){t=t.target;var e=this.F;e&&3==Yn(t)?e.f():this.Ca(t)},x.Ca=function(t){try{if(t==this.a)t:{var e=Yn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!pt&&!this.a.$())){this.A||4!=e||7==n||Ee(8==n||0>=r?3:2),Je(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,je(12),Ye(this),We(this);break t}me(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,$e(this,a)}this.I?(He(this,e,o),pt&&this.b&&3==e&&(ye(this.J,this.R,"tick",this.Wa),this.R.start())):(me(this.c,this.f,o,null),$e(this,o)),4==e&&Ye(this),this.b&&!this.A&&(4==e?pr(this.g,this):(this.b=!1,Ke(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,je(12)):(this.h=0,je(13)),Ye(this),We(this)}}}catch(c){}},x.Wa=function(){if(this.a){var t=Yn(this.a),e=this.a.$();this.D<e.length&&(Je(this),He(this,t,e),this.b&&4!=t&&Ke(this))}},x.cancel=function(){this.A=!0,Ye(this)},x.Va=function(){this.o=null;var t=G();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Ee(3),je(17)),Ye(this),this.h=2,We(this)):Xe(this,this.T-t)},(x=Ze.prototype).K=function(){tn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},x.L=function(){return tn(this),this.a.concat()},x.get=function(t,e){return en(this.b,t)?this.b[t]:e},x.set=function(t,e){en(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},x.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var nn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function rn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof rn){this.a=void 0!==e?e:t.a,sn(this,t.f),this.j=t.j,un(this,t.c),an(this,t.h),this.g=t.g,e=t.b;var n=new wn;n.c=e.c,e.a&&(n.a=new Ze(e.a),n.b=e.b),cn(this,n),this.i=t.i}else t&&(n=String(t).match(nn))?(this.a=!!e,sn(this,n[1]||"",!0),this.j=ln(n[2]||""),un(this,n[3]||"",!0),an(this,n[4]),this.g=ln(n[5]||"",!0),cn(this,n[6]||"",!0),this.i=ln(n[7]||"")):(this.a=!!e,this.b=new wn(null,this.a))}function on(t){return new rn(t)}function sn(t,e,n){t.f=n?ln(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function un(t,e,n){t.c=n?ln(e,!0):e}function an(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function cn(t,e,n){e instanceof wn?(t.b=e,function(t,e){e&&!t.f&&(In(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(On(this,e),En(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=pn(e,bn)),t.b=new wn(e,t.a))}function hn(t,e,n){t.b.set(e,n)}function fn(t){return hn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^G()).toString(36)),t}function ln(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function pn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,dn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function dn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}rn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(pn(e,vn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(pn(e,vn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(pn(n,"/"==n.charAt(0)?gn:yn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",pn(n,mn)),t.join("")};var vn=/[#\/\?@]/g,yn=/[#\?:]/g,gn=/[#\?]/g,bn=/[#\?@]/g,mn=/#/g;function wn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function In(t){t.a||(t.a=new Ze,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function On(t,e){In(t),e=Tn(t,e),en(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,en((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&tn(t)))}function _n(t,e){return In(t),e=Tn(t,e),en(t.a.b,e)}function En(t,e,n){On(t,e),0<n.length&&(t.c=null,t.a.set(Tn(t,e),W(n)),t.b+=n.length)}function Tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(x=wn.prototype).add=function(t,e){In(this),this.c=null,t=Tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},x.forEach=function(t,e){In(this),this.a.forEach(function(n,r){X(n,function(n){t.call(e,n,r,this)},this)},this)},x.L=function(){In(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},x.K=function(t){In(this);var e=[];if("string"==typeof t)_n(this,t)&&(e=J(e,this.a.get(Tn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=J(e,t[n])}return e},x.set=function(t,e){return In(this),this.c=null,_n(this,t=Tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},x.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},x.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var jn=function(){return function(t,e){this.b=t,this.a=e}}();function Sn(t){this.g=t||Nn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Nn=10;function An(t){return!!t.b||!!t.a&&t.a.size>=t.f}function xn(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Pn(t,e){t.a?t.a.add(e):t.b=e}function Dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Cn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return W(t.c)}function Ln(){}function Rn(){this.a=new Ln}function Un(t,e,n){var r=n||"";try{Qe(t,function(t,n){var i=t;R(t)&&(i=Qt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Bp){throw e.push(r+"type="+encodeURIComponent("_badmap")),Bp}}function Vn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Sn.prototype.cancel=function(){var t,e;if(this.c=Cn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Ln.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Ln.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Mn=D.JSON.parse;function qn(t){Wt.call(this),this.headers=new Ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Fn,this.D=this.F=!1}H(qn,Wt);var Fn="",zn=/^https?$/i,Gn=["POST","PUT"];function Hn(t){return"content-type"==t.toLowerCase()}function Bn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Kn(t),Jn(t)}function Kn(t){t.u||(t.u=!0,Yt(t,"complete"),Yt(t,"error"))}function Xn(t){if(t.b&&void 0!==P&&(!t.s[1]||4!=Yn(t)||2!=t.W()))if(t.l&&4==Yn(t))fe(t.za,0,t);else if(Yt(t,"readystatechange"),4==Yn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(nn)[1]||null;if(!o&&D.self&&D.self.location){var s=D.self.location.protocol;o=s.substr(0,s.length-1)}i=!zn.test(o?o.toLowerCase():"")}e=i}if(e)Yt(t,"complete"),Yt(t,"success");else{t.h=6;try{var u=2<Yn(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",Kn(t)}}finally{Jn(t)}}}function Jn(t,e){if(t.a){Wn(t);var n=t.a,r=t.s[0]?C:null;t.a=null,t.s=null,e||Yt(t,"ready");try{n.onreadystatechange=r}catch(Bp){}}}function Wn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Yn(t){return t.a?t.a.readyState:0}function $n(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return rt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):hn(t,e,n))}function Qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Zn(t){this.pa=0,this.g=[],this.c=new be,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Qn("baseRetryDelayMs",5e3,t),this.Ra=Qn("retryDelaySeedMs",1e4,t),this.Ma=Qn("forwardChannelMaxRetries",2,t),this.ma=Qn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Sn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function tr(t){if(nr(t),3==t.v){var e=t.R++,n=on(t.B);hn(n,"SID",t.J),hn(n,"RID",e),hn(n,"TYPE","terminate"),sr(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=fn(on(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=br(e.g,null),e.a.ba(e.i)),e.u=G(),Ke(e)}yr(t)}function er(t){t.a&&(hr(t),t.a.cancel(),t.a=null)}function nr(t){er(t),t.j&&(D.clearTimeout(t.j),t.j=null),lr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function rr(t,e){t.g.push(new jn(t.Oa++,e)),3==t.v&&ir(t)}function ir(t){An(t.b)||t.h||(t.h=!0,oe(t.Ba,t),t.u=0)}function or(t,e){var n;n=e?e.f:t.R++;var r=on(t.B);hn(r,"SID",t.J),hn(r,"RID",n),hn(r,"AID",t.P),sr(t,r),t.i&&t.l&&$n(r,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ur(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Pn(t.b,n),ze(n,r,e)}function sr(t,e){t.f&&Qe({},function(t,n){hn(e,n,t)})}function ur(t,e,n){n=Math.min(t.g.length,n);var r=t.f?F(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{Un(h,s,"req"+c+"_")}catch(ti){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ar(t){t.a||t.j||(t.T=1,oe(t.Aa,t),t.o=0)}function cr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Ne(F(t.Aa,t),dr(t,t.o)),t.o++,0))}function hr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function fr(t){t.a=new Ve(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=on(t.la);hn(e,"RID","rpc"),hn(e,"SID",t.J),hn(e,"CI",t.H?"0":"1"),hn(e,"AID",t.P),sr(t,e),hn(e,"TYPE","xmlhttp"),t.i&&t.l&&$n(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=fn(on(e)),n.j=null,n.I=!0,Ge(n,t)}function lr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function pr(t,e){var n=null;if(t.a==e){lr(t),hr(t),t.a=null;var r=2}else{if(!kn(t.b,e))return;n=e.s,Dn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=G()-e.u;var i=t.u;Yt(r=Oe(),new Se(r,n,e,i)),ir(t)}else ar(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(xn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Ne(F(t.Ba,t,e),dr(t,t.u)),t.u++,0)))}(t,e)||2==r&&cr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:vr(t,5);break;case 4:vr(t,10);break;case 3:vr(t,6);break;default:vr(t,2)}}function dr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function vr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=F(t.Ya,t);n||(n=new rn("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||sn(n,"https"),fn(n)),function(t,e){var n=new be;if(D.Image){var r=new Image;r.onload=z(Vn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=z(Vn,n,r,"TestLoadImage: error",!1,e),r.onabort=z(Vn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=z(Vn,n,r,"TestLoadImage: timeout",!1,e),D.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else je(2);t.v=0,t.f&&t.f.ra(e),yr(t),nr(t)}function yr(t){t.v=0,t.I=-1,t.f&&(0==Cn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function gr(t,e,n){var r=function(t){return t instanceof rn?on(t):new rn(t,void 0)}(n);if(""!=r.c)e&&un(r,e+"."+r.c),an(r,r.h);else{var i=D.location;r=function(t,e,n,r){var i=new rn(null,void 0);return t&&sn(i,t),e&&un(i,e),n&&an(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&rt(t.V,function(t,e){hn(r,e,t)}),n=t.na,(e=t.A)&&n&&hn(r,e,n),hn(r,"VER",t.ha),sr(t,r),r}function br(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new qn(t.Na)).F=t.C,e}function mr(){}function wr(){if(ft&&!(10<=Number(Ot)))throw Error("Environmental error: no available transport.")}function Ir(t,e){Wt.call(this),this.a=new Zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Y(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Y(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Er(this)}function Or(t){Le.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function _r(){Re.call(this),this.status=1}function Er(t){this.a=t}(x=qn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:De),this.a.onreadystatechange=F(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Bn(this,o)}t=n||"";var i=new Ze(this.headers);r&&Qe(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Hn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=D.FormData&&t instanceof D.FormData,!(0<=K(Gn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Wn(this),0<this.o&&((this.D=function(t){return ft&&It(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=F(this.xa,this)):this.m=fe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Bn(this,o)}},x.xa=function(){void 0!==P&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Yt(this,"timeout"),this.abort(8))},x.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Yt(this,"complete"),Yt(this,"abort"),Jn(this))},x.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Jn(this,!0)),qn.X.G.call(this)},x.za=function(){this.j||(this.A||this.l||this.g?Xn(this):this.Ua())},x.Ua=function(){Xn(this)},x.W=function(){try{return 2<Yn(this)?this.a.status:-1}catch(ct){return-1}},x.$=function(){try{return this.a?this.a.responseText:""}catch(ct){return""}},x.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Mn(e)}},x.ua=function(){return this.h},x.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(x=Zn.prototype).ha=8,x.v=1,x.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),r=this.l;if(this.O&&(r?st(r=it(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ur(this,n,e),hn(i=on(this.B),"RID",t),hn(i,"CVER",22),this.A&&hn(i,"X-HTTP-Session-Id",this.A),sr(this,i),this.i&&r&&$n(i,this.i,r),Pn(this.b,n),this.Ia&&hn(i,"TYPE","init"),this.da?(hn(i,"$req",e),hn(i,"SID","null"),n.U=!0,ze(n,i,null)):ze(n,i,e),this.v=2}}else 3==this.v&&(t?or(this,t):0==this.g.length||An(this.b)||or(this))},x.Aa=function(){if(this.j=null,fr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ne(F(this.Ta,this),t)}},x.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,je(10),er(this),fr(this))},x.Sa=function(){null!=this.m&&(this.m=null,er(this),cr(this),je(19))},x.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),je(2)):(this.c.info("Failed to ping google.com"),je(1))},(x=mr.prototype).ta=function(){},x.sa=function(){},x.ra=function(){},x.qa=function(){},x.Ja=function(){},wr.prototype.a=function(t,e){return new Ir(t,e)},H(Ir,Wt),Ir.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;je(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=gr(t,null,t.fa),ir(t)},Ir.prototype.close=function(){tr(this.a)},Ir.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,rr(this.a,e)}else this.l?((e={}).__data__=Qt(t),rr(this.a,e)):rr(this.a,t)},Ir.prototype.G=function(){this.a.f=null,delete this.f,tr(this.a),delete this.a,Ir.X.G.call(this)},H(Or,Le),H(_r,Re),H(Er,mr),Er.prototype.ta=function(){Yt(this.a,"a")},Er.prototype.sa=function(t){Yt(this.a,new Or(t))},Er.prototype.ra=function(t){Yt(this.a,new _r(t))},Er.prototype.qa=function(){Yt(this.a,"b")},wr.prototype.createWebChannel=wr.prototype.a,Ir.prototype.send=Ir.prototype.h,Ir.prototype.open=Ir.prototype.g,Ir.prototype.close=Ir.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,xe.COMPLETE="complete",Pe.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",Wt.prototype.listen=Wt.prototype.va,qn.prototype.listenOnce=qn.prototype.wa,qn.prototype.getLastError=qn.prototype.Qa,qn.prototype.getLastErrorCode=qn.prototype.ua,qn.prototype.getStatus=qn.prototype.W,qn.prototype.getResponseJson=qn.prototype.Pa,qn.prototype.getResponseText=qn.prototype.$,qn.prototype.send=qn.prototype.ba;var Tr=Ae,jr=xe,Sr=we,Nr=Pe,Ar=qn,xr=n("30Go"),kr=new j.b("@firebase/firestore");function Pr(){return kr.logLevel}function Dr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kr.logLevel<=j.a.DEBUG){var r=e.map(Rr);kr.debug.apply(kr,Object(xr.g)(["Firestore (8.2.2): "+t],r))}}function Cr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kr.logLevel<=j.a.ERROR){var r=e.map(Rr);kr.error.apply(kr,Object(xr.g)(["Firestore (8.2.2): "+t],r))}}function Lr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kr.logLevel<=j.a.WARN){var r=e.map(Rr);kr.warn.apply(kr,Object(xr.g)(["Firestore (8.2.2): "+t],r))}}function Rr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Bp){return t}}function Ur(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t;throw Cr(e),new Error(e)}function Vr(t,e){t||Ur()}function Mr(t,e){return t}function qr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Fr=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=qr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function zr(t,e){return t<e?-1:t>e?1:0}function Gr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Hr(t){return t+"\0"}var Br=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.i)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return zr(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();Br.h=new Br("");var Kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Xr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(xr.c)(e,t),e}(Error),Jr=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(Br.fromBase64String(e))}catch(e){throw new Xr(Kr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Br.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),Wr=function(t){this._=t};function Yr(){if("undefined"==typeof Uint8Array)throw new Xr(Kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function $r(){if("undefined"==typeof atob)throw new Xr(Kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Qr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.fromBase64String=function(t){return $r(),new e(Jr.fromBase64String(t))},e.fromUint8Array=function(t){return Yr(),new e(Jr.fromUint8Array(t))},e.prototype.toBase64=function(){return $r(),this._.toBase64()},e.prototype.toUint8Array=function(){return Yr(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Wr),Zr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},ti=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ei=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();ei.UNAUTHENTICATED=new ei(null),ei.P=new ei("google-credentials-uid"),ei.g=new ei("first-party-uid");var ni=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},ri=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(ei.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),ii=function(){function t(t){var e=this;this.C=null,this.currentUser=ei.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.O!==e?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Vr("string"==typeof n.accessToken),new ni(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new ei(t)},t}(),oi=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=ei.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),si=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new oi(this.k,this.M))},t.prototype.S=function(t){t(ei.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),ui=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();ui.U=-1;var ai=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Xr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Xr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Xr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Xr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?zr(this.nanoseconds,t.nanoseconds):zr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ci=function(){function t(t){this.timestamp=t}return t.j=function(e){return new t(e)},t.min=function(){return new t(new ai(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),hi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ur(),void 0===n?n=t.length-e:n>t.length-e&&Ur(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return this.Y(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(hi),li=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return li.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Xr(Kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Xr(Kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Xr(Kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(hi),di=function(){function t(t){this.path=t}return t.ft=function(e){return new t(fi.ct(e))},t.dt=function(e){return new t(fi.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===fi.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return fi.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new fi(e.slice()))},t}();function vi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function yi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var bi=function(){function t(t){this.fields=t,t.sort(pi.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return Gr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),mi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wi(t){if(Vr(!!t),"string"==typeof t){var e=0,n=mi.exec(t);if(Vr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ii(t.seconds),nanos:Ii(t.nanos)}}function Ii(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Oi(t){return"string"==typeof t?Br.fromBase64String(t):Br.fromUint8Array(t)}function _i(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ei(t){var e=t.mapValue.fields.__previous_value__;return _i(e)?Ei(e):e}function Ti(t){var e=wi(t.mapValue.fields.__local_write_time__.timestampValue);return new ai(e.seconds,e.nanos)}function ji(t){return null==t}function Si(t){return 0===t&&1/t==-1/0}function Ni(t){return"number"==typeof t&&Number.isInteger(t)&&!Si(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ai(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_i(t)?4:10:Ur()}function xi(t,e){var n=Ai(t);if(n!==Ai(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ti(t).isEqual(Ti(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=wi(t.timestampValue),r=wi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Oi(t.bytesValue).isEqual(Oi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ii(t.geoPointValue.latitude)===Ii(e.geoPointValue.latitude)&&Ii(t.geoPointValue.longitude)===Ii(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ii(t.integerValue)===Ii(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ii(t.doubleValue),r=Ii(e.doubleValue);return n===r?Si(n)===Si(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Gr(t.arrayValue.values||[],e.arrayValue.values||[],xi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(vi(n)!==vi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!xi(n[i],r[i])))return!1;return!0}(t,e);default:return Ur()}}function ki(t,e){return void 0!==(t.values||[]).find(function(t){return xi(t,e)})}function Pi(t,e){var n=Ai(t),r=Ai(e);if(n!==r)return zr(n,r);switch(n){case 0:return 0;case 1:return zr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Ii(t.integerValue||t.doubleValue),r=Ii(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Di(t.timestampValue,e.timestampValue);case 4:return Di(Ti(t),Ti(e));case 5:return zr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Oi(t),r=Oi(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=zr(n[i],r[i]);if(0!==o)return o}return zr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=zr(Ii(t.latitude),Ii(e.latitude));return 0!==n?n:zr(Ii(t.longitude),Ii(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Pi(n[i],r[i]);if(o)return o}return zr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=zr(r[s],o[s]);if(0!==u)return u;var a=Pi(n[r[s]],i[o[s]]);if(0!==a)return a}return zr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ur()}}function Di(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return zr(t,e);var n=wi(t),r=wi(e),i=zr(n.seconds,r.seconds);return 0!==i?i:zr(n.nanos,r.nanos)}function Ci(t){return Li(t)}function Li(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=wi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Oi(t.bytesValue).toBase64():"referenceValue"in t?di.dt(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Li(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Li(t.fields[o])}return e+"}"}(t.mapValue):Ur();var e}function Ri(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Ui(t){return!!t&&"integerValue"in t}function Vi(t){return!!t&&"arrayValue"in t}function Mi(t){return!!t&&"nullValue"in t}function qi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fi(t){return!!t&&"mapValue"in t}var zi=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Fi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return xi(this.proto,t.proto)},t}(),Gi=function(){function t(t){void 0===t&&(t=zi.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Ai(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(pi.at(),this.Rt);return null!=t?new zi(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Fi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Hi(t){var e=[];return yi(t.fields||{},function(t,n){var r=new pi([t]);if(Fi(n)){var i=Hi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new bi(e)}var Bi=function(t,e){this.key=t,this.version=e},Ki=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(xr.c)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Bi),Xi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(xr.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Bi),Ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Bi),Wi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Yi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Wi(t,e,n,r,i,o,s)}function $i(t){var e=Mr(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+Ci(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),ji(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ho(e.startAt)),e.endAt&&(n+="|ub:",n+=ho(e.endAt)),e.St=n}return e.St}function Qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!lo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!xi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vo(t.startAt,e.startAt)&&vo(t.endAt,e.endAt)}function Zi(t){return di.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var to=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(xr.c)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new eo(t,n,r):"array-contains"===n?new oo(t,r):"in"===n?new so(t,r):"not-in"===n?new uo(t,r):"array-contains-any"===n?new ao(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new no(t,n):new ro(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(Pi(e,this.value)):null!==e&&Ai(this.value)===Ai(e)&&this.Ct(Pi(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ur()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),eo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=di.dt(r.referenceValue),i}return Object(xr.c)(e,t),e.prototype.matches=function(t){var e=di.J(t.key,this.key);return this.Ct(e)},e}(to),no=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=io(0,n),r}return Object(xr.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(to),ro=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=io(0,n),r}return Object(xr.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(to);function io(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return di.dt(t.referenceValue)})}var oo=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(xr.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Vi(e)&&ki(e.arrayValue,this.value)},e}(to),so=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(xr.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ki(this.value.arrayValue,e)},e}(to),uo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(xr.c)(e,t),e.prototype.matches=function(t){if(ki(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ki(this.value.arrayValue,e)},e}(to),ao=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(xr.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Vi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ki(e.value.arrayValue,t)})},e}(to),co=function(t,e){this.position=t,this.before=e};function ho(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Ci(t)}).join(",")}var fo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function lo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function po(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?di.J(di.dt(s.referenceValue),n.key):Pi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function vo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!xi(t.position[n],e.position[n]))return!1;return!0}var yo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null};function go(t,e,n,r,i,o,s,u){return new yo(t,e,n,r,i,o,s,u)}function bo(t){return new yo(t)}function mo(t){return!ji(t.limit)&&"F"===t.limitType}function wo(t){return!ji(t.limit)&&"L"===t.limitType}function Io(t){return t.Nt.length>0?t.Nt[0].field:null}function Oo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function _o(t){return null!==t.collectionGroup}function Eo(t){var e=Mr(t);if(null===e.Ot){e.Ot=[];var n=Oo(e),r=Io(e);if(null!==n&&null===r)n.ht()||e.Ot.push(new fo(n)),e.Ot.push(new fo(pi.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ot.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ot.push(new fo(pi.lt(),a))}}}return e.Ot}function To(t){var e=Mr(t);if(!e.Ft)if("F"===e.limitType)e.Ft=Yi(e.path,e.collectionGroup,Eo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Eo(e);r<i.length;r++){var o=i[r];n.push(new fo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new co(e.endAt.position,!e.endAt.before):null,u=e.startAt?new co(e.startAt.position,!e.startAt.before):null;e.Ft=Yi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.Ft}function jo(t,e,n){return new yo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function So(t,e){return Qi(To(t),To(e))&&t.limitType===e.limitType}function No(t){return $i(To(t))+"|lt:"+t.limitType}function Ao(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+Ci(e.value);var e}).join(", ")+"]"),ji(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ho(t.startAt)),t.endAt&&(e+=", endAt: "+ho(t.endAt)),"Target("+e+")"}(To(t))+"; limitType="+t.limitType+")"}function xo(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):di.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!po(t.startAt,Eo(t),e)||t.endAt&&po(t.endAt,Eo(t),e))}(t,e)}function ko(t){return function(e,n){for(var r=!1,i=0,o=Eo(t);i<o.length;i++){var s=o[i],u=Po(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function Po(t,e,n){var r=t.field.ht()?di.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Pi(r,i):Ur()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ur()}}var Do=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ci.min()),void 0===o&&(o=ci.min()),void 0===s&&(s=Br.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function Co(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Si(e)?"-0":e}}function Lo(t){return{integerValue:""+t}}function Ro(t,e){return Ni(e)?Lo(e):Co(t,e)}var Uo=function(){this.Ut=void 0};function Vo(t,e,n){return t instanceof Fo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof zo?Go(t,e):t instanceof Ho?Bo(t,e):function(t,e){var n=qo(t,e),r=Xo(n)+Xo(t.Qt);return Ui(n)&&Ui(t.Qt)?Lo(r):Co(t.Kt,r)}(t,e)}function Mo(t,e,n){return t instanceof zo?Go(t,e):t instanceof Ho?Bo(t,e):n}function qo(t,e){return t instanceof Ko?Ui(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e}(Uo),zo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(xr.c)(e,t),e}(Uo);function Go(t,e){for(var n=Jo(e),r=function(t){n.some(function(e){return xi(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ho=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(xr.c)(e,t),e}(Uo);function Bo(t,e){for(var n=Jo(e),r=function(t){n=n.filter(function(e){return!xi(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ko=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Object(xr.c)(e,t),e}(Uo);function Xo(t){return Ii(t.integerValue||t.doubleValue)}function Jo(t){return Vi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Wo=function(t,e){this.field=t,this.transform=e},Yo=function(t,e){this.version=t,this.transformResults=e},$o=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.jt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Qo(t,e){return void 0!==t.updateTime?e instanceof Ki&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ki}var Zo=function(){};function ts(t,e,n){return t instanceof os?function(t,e,n){var r=t.value;if(n.transformResults){var i=as(t.fieldTransforms,e,n.transformResults);r=hs(t.fieldTransforms,r,i)}return new Ki(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ss?function(t,e,n){if(!Qo(t.Gt,e))return new Ji(t.key,n.version);var r=us(t,e,n.transformResults?as(t.fieldTransforms,e,n.transformResults):[]);return new Ki(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Xi(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function es(t,e,n,r){return t instanceof os?function(t,e,n,r){if(!Qo(t.Gt,e))return e;var i=t.value,o=cs(t.fieldTransforms,n,e);i=hs(t.fieldTransforms,i,o);var s=is(e);return new Ki(t.key,s,i,{bt:!0})}(t,e,r):t instanceof ss?function(t,e,n,r){if(!Qo(t.Gt,e))return e;var i=is(e),o=us(t,e,cs(t.fieldTransforms,n,e));return new Ki(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Qo(t.Gt,e)?new Xi(t.key,ci.min()):e}(t,e)}function ns(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Ki?e.field(o.field):void 0,u=qo(o.transform,s||null);null!=u&&(n=null==n?(new Gi).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e)}function rs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Gr(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof zo&&e instanceof zo||t instanceof Ho&&e instanceof Ho?Gr(t.elements,e.elements,xi):t instanceof Ko&&e instanceof Ko?xi(t.Qt,e.Qt):t instanceof Fo&&e instanceof Fo}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function is(t){return t instanceof Ki?t.version:ci.min()}var os=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Object(xr.c)(e,t),e}(Zo),ss=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Object(xr.c)(e,t),e}(Zo);function us(t,e,n){var r;return r=function(t,e){var n=new Gi(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof Ki?e.data():zi.empty()),hs(t.fieldTransforms,r,n)}function as(t,e,n){var r=[];Vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ki&&(u=e.field(o.field)),r.push(Mo(s,u,n[i]))}return r}function cs(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Ki&&(c=n.field(u.field)),i.push(Vo(a,c,e))}return i}function hs(t,e,n){for(var r=new Gi(e),i=0;i<t.length;i++)r.set(t[i].field,n[i]);return r.yt()}var fs,ls,ps=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Object(xr.c)(e,t),e}(Zo),ds=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Object(xr.c)(e,t),e}(Zo),vs=function(t){this.count=t};function ys(t){switch(t){case Kr.OK:return Ur();case Kr.CANCELLED:case Kr.UNKNOWN:case Kr.DEADLINE_EXCEEDED:case Kr.RESOURCE_EXHAUSTED:case Kr.INTERNAL:case Kr.UNAVAILABLE:case Kr.UNAUTHENTICATED:return!1;case Kr.INVALID_ARGUMENT:case Kr.NOT_FOUND:case Kr.ALREADY_EXISTS:case Kr.PERMISSION_DENIED:case Kr.FAILED_PRECONDITION:case Kr.ABORTED:case Kr.OUT_OF_RANGE:case Kr.UNIMPLEMENTED:case Kr.DATA_LOSS:return!0;default:return Ur()}}function gs(t){if(void 0===t)return Cr("GRPC error has no .code"),Kr.UNKNOWN;switch(t){case fs.OK:return Kr.OK;case fs.CANCELLED:return Kr.CANCELLED;case fs.UNKNOWN:return Kr.UNKNOWN;case fs.DEADLINE_EXCEEDED:return Kr.DEADLINE_EXCEEDED;case fs.RESOURCE_EXHAUSTED:return Kr.RESOURCE_EXHAUSTED;case fs.INTERNAL:return Kr.INTERNAL;case fs.UNAVAILABLE:return Kr.UNAVAILABLE;case fs.UNAUTHENTICATED:return Kr.UNAUTHENTICATED;case fs.INVALID_ARGUMENT:return Kr.INVALID_ARGUMENT;case fs.NOT_FOUND:return Kr.NOT_FOUND;case fs.ALREADY_EXISTS:return Kr.ALREADY_EXISTS;case fs.PERMISSION_DENIED:return Kr.PERMISSION_DENIED;case fs.FAILED_PRECONDITION:return Kr.FAILED_PRECONDITION;case fs.ABORTED:return Kr.ABORTED;case fs.OUT_OF_RANGE:return Kr.OUT_OF_RANGE;case fs.UNIMPLEMENTED:return Kr.UNIMPLEMENTED;case fs.DATA_LOSS:return Kr.DATA_LOSS;default:return Ur()}}(ls=fs||(fs={}))[ls.OK=0]="OK",ls[ls.CANCELLED=1]="CANCELLED",ls[ls.UNKNOWN=2]="UNKNOWN",ls[ls.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ls[ls.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ls[ls.NOT_FOUND=5]="NOT_FOUND",ls[ls.ALREADY_EXISTS=6]="ALREADY_EXISTS",ls[ls.PERMISSION_DENIED=7]="PERMISSION_DENIED",ls[ls.UNAUTHENTICATED=16]="UNAUTHENTICATED",ls[ls.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ls[ls.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ls[ls.ABORTED=10]="ABORTED",ls[ls.OUT_OF_RANGE=11]="OUT_OF_RANGE",ls[ls.UNIMPLEMENTED=12]="UNIMPLEMENTED",ls[ls.INTERNAL=13]="INTERNAL",ls[ls.UNAVAILABLE=14]="UNAVAILABLE",ls[ls.DATA_LOSS=15]="DATA_LOSS";var bs=function(){function t(t,e){this.J=t,this.root=e||ws.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,ws.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,ws.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new ms(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new ms(this.root,t,this.J,!1)},t.prototype.se=function(){return new ms(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new ms(this.root,t,this.J,!0)},t}(),ms=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),ws=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw Ur();if(this.right._e())throw Ur();var t=this.left.me();if(t!==this.right.me())throw Ur();return t+(this._e()?0:1)},t}();ws.EMPTY=null,ws.RED=!0,ws.Jt=!1,ws.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new ws(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var Is=function(){function t(t){this.J=t,this.data=new bs(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new Os(this.data.ee())},t.prototype.ne=function(t){return new Os(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),Os=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),_s=new bs(di.J);function Es(){return _s}function Ts(){return Es()}var js=new bs(di.J);function Ss(){return js}var Ns=new bs(di.J);function As(){return Ns}var xs=new Is(di.J);function ks(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=xs,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ps=new Is(zr);function Ds(){return Ps}var Cs=function(){function t(t){this.J=t?function(e,n){return t(e,n)||di.J(e.key,n.key)}:function(t,e){return di.J(t.key,e.key)},this.Ve=Ss(),this.pe=new bs(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),Ls=function(){function t(){this.ve=new bs(di.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Ur():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),Rs=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Oe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Cs.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&So(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Us=function(){function t(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,Vs.Be(e,n)),new t(ci.min(),r,Ds(),Es(),ks())},t}(),Vs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(Br.h,n,ks(),ks(),ks())},t}(),Ms=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},qs=function(t,e){this.targetId=t,this.Ge=e},Fs=function(t,e,n,r){void 0===n&&(n=Br.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},zs=function(){function t(){this.ze=0,this.He=Bs(),this.Je=Br.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=ks(),e=ks(),n=ks();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ur()}}),new Vs(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=Bs()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),Gs=function(){function t(t){this.hn=t,this.ln=new Map,this._n=Es(),this.fn=Hs(),this.dn=new Is(zr)}return t.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Ki?this.En(r,t.We):t.We instanceof Xi&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Tn(r=o[i],t.key,t.We)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:Ur()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(Zi(i))if(0===n){var o=new di(i.path);this.Tn(e,o,new Xi(o,ci.min()))}else Vr(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&Zi(o.target)){var s=new di(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new Xi(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=ks();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Us(t,n,this.dn,this._n,r);return this._n=Es(),this.fn=Hs(),this.dn=new Is(zr),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new zs,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new Is(zr),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new zs),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function Hs(){return new bs(di.J)}function Bs(){return new bs(di.J)}var Ks={asc:"ASCENDING",desc:"DESCENDING"},Xs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Js=function(t,e){this.T=t,this.qt=e};function Ws(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ys(t,e){return t.qt?e.toBase64():e.toUint8Array()}function $s(t,e){return Ws(t,e.G())}function Qs(t){return Vr(!!t),ci.j(function(t){var e=wi(t);return new ai(e.seconds,e.nanos)}(t))}function Zs(t,e){return function(t){return new fi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function tu(t){var e=fi.ct(t);return Vr(Eu(e)),e}function eu(t,e){return Zs(t.T,e.path)}function nu(t,e){var n=tu(e);if(n.get(1)!==t.T.projectId)throw new Xr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new Xr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new di(su(n))}function ru(t,e){return Zs(t.T,e)}function iu(t){var e=tu(t);return 4===e.length?fi.at():su(e)}function ou(t){return new fi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function su(t){return Vr(t.length>4&&"documents"===t.get(4)),t.X(5)}function uu(t,e,n){return{name:eu(t,e),fields:n.proto.mapValue.fields}}function au(t,e,n){var r=nu(t,e.name),i=Qs(e.updateTime),o=new zi({mapValue:{fields:e.fields}});return new Ki(r,i,o,{hasCommittedMutations:!!n})}function cu(t,e){var n;if(e instanceof os)n={update:uu(t,e.key,e.value)};else if(e instanceof ps)n={delete:eu(t,e.key)};else if(e instanceof ss)n={update:uu(t,e.key,e.data),updateMask:_u(e.zt)};else{if(!(e instanceof ds))return Ur();n={verify:eu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Fo)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof zo)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof Ho)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof Ko)return{fieldPath:e.field.ot(),increment:n.Qt};throw Ur()}(0,t)})),e.Gt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:$s(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ur()}(t,e.Gt)),n}function hu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?$o.updateTime(Qs(t.updateTime)):void 0!==t.exists?$o.exists(t.exists):$o.jt()}(e.currentDocument):$o.jt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Vr("REQUEST_TIME"===e.setToServerValue),n=new Fo):"appendMissingElements"in e?n=new zo(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ho(e.removeAllFromArray.values||[]):"increment"in e?n=new Ko(t,e.increment):Ur();var r=pi._t(e.fieldPath);return new Wo(r,n)}(t,e)}):[];if(e.update){var i=nu(t,e.update.name),o=new zi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new bi((t.fieldPaths||[]).map(function(t){return pi._t(t)}))}(e.updateMask);return new ss(i,o,s,n,r)}return new os(i,o,n,r)}if(e.delete){var u=nu(t,e.delete);return new ps(u,n)}if(e.verify){var a=nu(t,e.verify);return new ds(a,n)}return Ur()}function fu(t,e){return{documents:[ru(t,e.path)]}}function lu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ru(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ru(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(qi(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NAN"}};if(Mi(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(qi(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NOT_NAN"}};if(Mi(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mu(t.field),op:bu(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:mu(t.field),direction:gu(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||ji(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=vu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=vu(e.endAt)),n}function pu(t){var e=iu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Vr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=du(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new fo(wu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return ji(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=yu(n.startAt));var h=null;return n.endAt&&(h=yu(n.endAt)),go(e,i,u,s,a,"F",c,h)}function du(t){return t?void 0!==t.unaryFilter?[Ou(t)]:void 0!==t.fieldFilter?[Iu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return du(t)}).reduce(function(t,e){return t.concat(e)}):Ur():[]}function vu(t){return{before:t.before,values:t.position}}function yu(t){return new co(t.values||[],!!t.before)}function gu(t){return Ks[t]}function bu(t){return Xs[t]}function mu(t){return{fieldPath:t.ot()}}function wu(t){return pi._t(t.fieldPath)}function Iu(t){return to.create(wu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ur()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ou(t){switch(t.unaryFilter.op){case"IS_NAN":var e=wu(t.unaryFilter.field);return to.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=wu(t.unaryFilter.field);return to.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=wu(t.unaryFilter.field);return to.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=wu(t.unaryFilter.field);return to.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ur()}}function _u(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function Eu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Tu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},ju=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.On&&Ur(),this.On=!0,this.Nn?this.error?this.Fn(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.Fn(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),Su=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new Tu,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new xu(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=Lu(e.target.error);n.qn.reject(new xu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new xu(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Pu(e)},t}(),Nu=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(Object(S.g)())&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Dr("SimpleDb","Removing database:",t),Du(window.indexedDB.deleteDatabase(t)).Mn()},t.jn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=Object(S.g)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n=this;return Object(xr.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new xu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Xr(Kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new xu(t,n))},i.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Qn.Yn(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Dr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(xr.b)(this,void 0,void 0,function(){var i,o,s,u,a;return Object(xr.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(xr.d)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=Su.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),ju.reject(t)}).Mn(),a={},s.catch(function(){}),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return Dr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Au=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return Du(this.ts.delete())},t}(),xu=function(t){function e(e,n){var r=this;return(r=t.call(this,Kr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(xr.c)(e,t),e}(Xr);function ku(t){return"IndexedDbTransactionError"===t.name}var Pu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Du(n)},t.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Du(this.store.add(t))},t.prototype.get=function(t){var e=this;return Du(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Dr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Du(this.store.delete(t))},t.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Du(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new ju(function(n,r){e.onerror=function(t){var e=Lu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new ju(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Au(i),s=e(i.primaryKey,i.value,o);if(s instanceof ju){var u=s.catch(function(t){return o.done(),ju.reject(t)});n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return ju.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Du(t){return new ju(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Lu(t.target.error);n(e)}})}var Cu=!1;function Lu(t){var e=Nu.Kn(Object(S.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Xr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Cu||(Cu=!0,setTimeout(function(){throw r},0)),r}}return t}var Ru=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new Tu,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Xr(Kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function Uu(t,e){if(Cr("AsyncQueue",e+": "+t),ku(t))return new Xr(Kr.UNAVAILABLE,e+": "+t);throw t}var Vu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Mu=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function qu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=zu(e)),e=Fu(t.get(n),e);return zu(e)}function Fu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function zu(t){return t+"\x01\x01"}function Gu(t){var e=t.length;if(Vr(e>=2),2===e)return Vr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),fi.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Ur(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Ur()}o=s+2}return new fi(r)}var Hu=function(t,e){this.seconds=t,this.nanoseconds=e},Bu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Bu.store="owner",Bu.key="owner";var Ku=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ku.store="mutationQueues",Ku.keyPath="userId";var Xu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Xu.store="mutations",Xu.keyPath="batchId",Xu.userMutationsIndex="userMutationsIndex",Xu.userMutationsKeyPath=["userId","batchId"];var Ju=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,qu(e)]},t.key=function(t,e,n){return[t,qu(e),n]},t}();Ju.store="documentMutations",Ju.PLACEHOLDER=new Ju;var Wu=function(t,e){this.path=t,this.readTime=e},Yu=function(t,e){this.path=t,this.version=e},$u=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};$u.store="remoteDocuments",$u.readTimeIndex="readTimeIndex",$u.readTimeIndexPath="readTime",$u.collectionReadTimeIndex="collectionReadTimeIndex",$u.collectionReadTimeIndexPath=["parentPath","readTime"];var Qu=function(t){this.byteSize=t};Qu.store="remoteDocumentGlobal",Qu.key="remoteDocumentGlobalKey";var Zu=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Zu.store="targets",Zu.keyPath="targetId",Zu.queryTargetsIndexName="queryTargetsIndex",Zu.queryTargetsKeyPath=["canonicalId","targetId"];var ta=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ta.store="targetDocuments",ta.keyPath=["targetId","path"],ta.documentTargetsIndex="documentTargetsIndex",ta.documentTargetsKeyPath=["path","targetId"];var ea=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ea.key="targetGlobalKey",ea.store="targetGlobal";var na=function(t,e){this.collectionId=t,this.parent=e};na.store="collectionParents",na.keyPath=["collectionId","parent"];var ra=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ra.store="clientMetadata",ra.keyPath="clientId";var ia=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ia.store="bundles",ia.keyPath="bundleId";var oa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};oa.store="namedQueries",oa.keyPath="name";var sa=Object(xr.g)(Object(xr.g)(Object(xr.g)(Object(xr.g)([Ku.store,Xu.store,Ju.store,$u.store,Zu.store,Bu.store,ea.store,ta.store],[ra.store]),[Qu.store]),[na.store]),[ia.store,oa.store]),ua=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Object(xr.c)(e,t),e}(Mu);function aa(t,e){var n=Mr(t);return Nu.Hn(n.bs,e)}var ca=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ts(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=es(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=es(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ks())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Gr(this.mutations,t.mutations,function(t,e){return rs(t,e)})&&Gr(this.baseMutations,t.baseMutations,function(t,e){return rs(t,e)})},t}(),ha=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}return t.from=function(e,n,r){Vr(e.mutations.length===r.length);for(var i=As(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),fa=function(t){this.ks=t};function la(t,e){if(e.document)return au(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=di.Tt(e.noDocument.path),r=ga(e.noDocument.readTime);return new Xi(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=di.Tt(e.unknownDocument.path);return r=ga(e.unknownDocument.version),new Ji(i,r)}return Ur()}function pa(t,e,n){var r=da(n),i=e.key.path.Z().rt();if(e instanceof Ki){var o=function(t,e){return{name:eu(t,e.key),fields:e.vt().mapValue.fields,updateTime:Ws(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new $u(null,null,o,s,r,i)}if(e instanceof Xi){var u=e.key.path.rt(),a=ya(e.version);return s=e.hasCommittedMutations,new $u(null,new Wu(u,a),null,s,r,i)}if(e instanceof Ji){var c=e.key.path.rt(),h=ya(e.version);return new $u(new Yu(c,h),null,null,!0,r,i)}return Ur()}function da(t){var e=t.G();return[e.seconds,e.nanoseconds]}function va(t){var e=new ai(t[0],t[1]);return ci.j(e)}function ya(t){var e=t.G();return new Hu(e.seconds,e.nanoseconds)}function ga(t){var e=new ai(t.seconds,t.nanoseconds);return ci.j(e)}function ba(t,e){for(var n=(e.baseMutations||[]).map(function(e){return hu(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return hu(t.ks,e)}),s=ai.fromMillis(e.localWriteTimeMs);return new ca(e.batchId,s,n,o)}function ma(t){var e,n,r=ga(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ga(t.lastLimboFreeSnapshotVersion):ci.min();return void 0!==t.query.documents?(Vr(1===(n=t.query).documents.length),e=To(bo(iu(n.documents[0])))):e=function(t){return To(pu(t))}(t.query),new Do(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Br.fromBase64String(t.resumeToken))}function wa(t,e){var n,r=ya(e.Mt),i=ya(e.lastLimboFreeSnapshotVersion);n=Zi(e.target)?fu(t.ks,e.target):lu(t.ks,e.target);var o=e.resumeToken.toBase64();return new Zu(e.targetId,$i(e.target),r,o,e.sequenceNumber,i,n)}function Ia(t){var e=pu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?jo(e,e.limit,"L"):e}var Oa=function(){function t(){}return t.prototype.Ms=function(t,e){return _a(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ga(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return _a(t).put({bundleId:(n=e).id,createTime:ya(Qs(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return Ea(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Ia(e.bundledQuery),readTime:ga(e.readTime)};var e})},t.prototype.Bs=function(t,e){return Ea(t).put(function(t){return{name:t.name,readTime:ya(Qs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function _a(t){return aa(t,ia.store)}function Ea(t){return aa(t,oa.store)}var Ta=function(){function t(){this.qs=new ja}return t.prototype.Us=function(t,e){return this.qs.add(e),ju.resolve()},t.prototype.Qs=function(t,e){return ju.resolve(this.qs.getEntries(e))},t}(),ja=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new Is(fi.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Is(fi.J)).rt()},t}(),Sa=function(){function t(){this.Ks=new ja}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:qu(i)};return Na(t).put(o)}return ju.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Hr(e),""],!1,!0);return Na(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Gu(o.parent))}return n})},t}();function Na(t){return aa(t,na.store)}var Aa={js:!1,Ws:0,Gs:0,zs:0},xa=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function ka(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){if(t.code!==Kr.FAILED_PRECONDITION||t.message!==Vu)throw t;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}xa.Zs=10,xa.ti=1e3,xa.ei=new xa(41943040,xa.Zs,xa.ti),xa.ni=new xa(-1,0,0);var Pa=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.ii(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){yi(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.nt=function(){return gi(this.ri)},t}(),Da=function(){function t(){this.oi=new Pa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:ci.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?ju.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function Ca(t,e,n){var r=t.store(Xu.store),i=t.store(Ju.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Vr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Ju.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ju.$n(o).next(function(){return c})}function La(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ur();e=t.noDocument}return JSON.stringify(e).length}var Ra=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return Vr(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Va(t).ls({index:Xu.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=Ma(t),s=Va(t);return s.add({}).next(function(u){Vr("number"==typeof u);for(var a=new ca(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return cu(t.ks,e)}),i=n.mutations.map(function(e){return cu(t.ks,e)});return new Xu(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new Is(function(t,e){return zr(t.ot(),e.ot())}),l=0,p=r;l<p.length;l++){var d=p[l],v=Ju.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,Ju.PLACEHOLDER))}return f.forEach(function(e){h.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[u]=a.keys()}),ju.$n(h).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return Va(t).get(e).next(function(t){return t?(Vr(t.userId===n.userId),ba(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?ju.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Va(t).ls({index:Xu.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Vr(e.batchId>=r),o=ba(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Va(t).ls({index:Xu.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Va(t).os(Xu.userMutationsIndex,n).next(function(t){return t.map(function(t){return ba(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=Ju.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ma(t).ls({range:i},function(r,i,s){var u=r[0],a=r[2],c=Gu(r[1]);if(u===n.userId&&e.path.isEqual(c))return Va(t).get(a).next(function(t){if(!t)throw Ur();Vr(t.userId===n.userId),o.push(ba(n.Kt,t))});s.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new Is(zr),i=[];return e.forEach(function(e){var o=Ju.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Ma(t).ls({range:s},function(t,i,o){var s=t[0],u=t[2],a=Gu(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()});i.push(u)}),ju.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ju.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Is(zr);return Ma(t).ls({range:s},function(t,e,o){var s=t[0],a=t[2],c=Gu(t[1]);s===n.userId&&r.st(c)?c.length===i&&(u=u.add(a)):o.done()}).next(function(){return n.Di(t,u)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Va(t).get(e).next(function(t){if(null===t)throw Ur();Vr(t.userId===n.userId),r.push(ba(n.Kt,t))}))}),ju.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return Ca(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),ju.forEach(r,function(e){return n.Ii.Oi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Fi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return ju.resolve();var r=IDBKeyRange.lowerBound(Ju.prefixForUser(e.userId)),i=[];return Ma(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=Gu(t[1]);i.push(o)}else r.done()}).next(function(){Vr(0===i.length)})})},t.prototype.ki=function(t,e){return Ua(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return qa(t).get(this.userId).next(function(t){return t||new Ku(e.userId,-1,"")})},t}();function Ua(t,e,n){var r=Ju.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ma(t).ls({range:o,hs:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Va(t){return aa(t,Xu.store)}function Ma(t){return aa(t,Ju.store)}function qa(t){return aa(t,Ku.store)}var Fa=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),za=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new Fa(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return ci.j(new ai(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.ji=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return Ga(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return Vr(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return Ga(t).ls(function(s,u){var a=ma(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return ju.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return Ga(t).ls(function(t,n){var r=ma(n);e(r)})},t.prototype.Ui=function(t){return Ha(t).get(ea.key).next(function(t){return Vr(null!==t),t})},t.prototype.Qi=function(t,e){return Ha(t).put(ea.key,e)},t.prototype.zi=function(t,e){return Ga(t).put(wa(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=$i(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ga(t).ls({range:r,index:Zu.queryTargetsIndexName},function(t,n,r){var o=ma(n);Qi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=Ba(t);return e.forEach(function(e){var s=qu(e.path);i.push(o.put(new ta(n,s))),i.push(r.Ii.sr(t,n,e))}),ju.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=Ba(t);return ju.forEach(e,function(e){var o=qu(e.path);return ju.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=Ba(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ba(t),i=ks();return r.ls({range:n,hs:!0},function(t,e,n){var r=Gu(t[1]),o=new di(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=qu(e.path),r=IDBKeyRange.bound([n],[Hr(n)],!1,!0),i=0;return Ba(t).ls({index:ta.documentTargetsIndex,hs:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return Ga(t).get(e).next(function(t){return t?ma(t):null})},t}();function Ga(t){return aa(t,Zu.store)}function Ha(t){return aa(t,ea.store)}function Ba(t){return aa(t,ta.store)}function Ka(t,e){var n=t[1],r=e[1],i=zr(t[0],e[0]);return 0===i?zr(n,r):i}var Xa=function(){function t(t){this.ar=t,this.buffer=new Is(Ka),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ka(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ja=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return Object(xr.b)(e,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return ku(e=n.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ka(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),Wa=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return ju.resolve(ui.U);var r=new Xa(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),ju.resolve(Aa)):this.br(t).next(function(r){return r<n.params.Hs?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),Aa):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>c.params.Ys?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)}).next(function(r){return n=r,s=Date.now(),c.Zi(t,n,e)}).next(function(e){return i=e,u=Date.now(),c.Vr(t,n)}).next(function(t){return a=Date.now(),Pr()<=j.a.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),ju.resolve({js:!0,Ws:r,Gs:i,zs:t})})},t}(),Ya=function(){function t(t,e){this.db=t,this._r=function(t,e){return new Wa(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return $a(t,n)},t.prototype.rr=function(t,e,n){return $a(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Oi=function(t,e){return $a(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return qa(t)._s(function(r){return Ua(t,r,e).next(function(t){return t&&(n=!0),ju.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,function(s,u){if(u<=e){var a=n.Nr(t,s).next(function(e){if(!e)return o++,r.fi(t,s).next(function(){return r._i(s),Ba(t).delete([0,qu(s.path)])})});i.push(a)}}).next(function(){return ju.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return $a(t,e)},t.prototype.Cr=function(t,e){var n,r=Ba(t),i=ui.U;return r.ls({index:ta.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==ui.U&&e(new di(Gu(n)),i),i=s,n=o):i=ui.U}).next(function(){i!==ui.U&&e(new di(Gu(n)),i)})},t.prototype.br=function(t){return this.db.Fr().Mr(t)},t}();function $a(t,e){return Ba(t).put(function(t,e){return new ta(0,qu(t.path),e)}(e,t.vs))}var Qa=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return ec(t).put(nc(e),n)},t.prototype._i=function(t,e){var n=ec(t),r=nc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return ec(t).get(nc(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return ec(t).get(nc(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:La(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Ts();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=Ts(),i=new bs(di.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,La(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return ju.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return ec(t).ls({range:r},function(t,e,r){for(var s=di.Tt(t);o&&di.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.jr=function(t,e,n){var r=this,i=Ss(),o=e.path.length+1,s={};if(n.isEqual(ci.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=da(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=$u.collectionReadTimeIndex}return ec(t).ls(s,function(t,n,s){if(t.length===o){var u=la(r.Kt,n);e.path.st(u.key.path)?u instanceof Ki&&xo(e,u)&&(i=i.Ht(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Or=function(t){return new Za(this,!!t&&t.Wr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return tc(t).get(Qu.key).next(function(t){return Vr(!!t),t})},t.prototype.Lr=function(t,e){return tc(t).put(Qu.key,e)},t.prototype.$r=function(t){if(t){var e=la(this.Kt,t);return e instanceof Xi&&e.version.isEqual(ci.min())?null:e}return null},t}(),Za=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.Wr=n,r.zr=new Pa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(xr.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new Is(function(t,e){return zr(t.ot(),e.ot())});return this.oi.forEach(function(o,s){var u=e.zr.get(o);if(s.li){var a=pa(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=La(a);r+=c-u,n.push(e.Gr.ui(t,o,a))}else if(r-=u,e.Wr){var h=pa(e.Gr.Kt,new Xi(o,ci.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),ju.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(Da);function tc(t){return aa(t,Qu.store)}function ec(t){return aa(t,$u.store)}function nc(t){return t.path.rt()}var rc=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;Vr(n<r&&n>=0&&r<=11);var o=new Su("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Bu.store)}(t),function(t){t.createObjectStore(Ku.store,{keyPath:Ku.keyPath}),t.createObjectStore(Xu.store,{keyPath:Xu.keyPath,autoIncrement:!0}).createIndex(Xu.userMutationsIndex,Xu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ju.store)}(t),ic(t),function(t){t.createObjectStore($u.store)}(t));var s=ju.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ta.store),t.deleteObjectStore(Zu.store),t.deleteObjectStore(ea.store)}(t),ic(t)),s=s.next(function(){return function(t){var e=t.store(ea.store),n=new ea(0,0,ci.min().G(),0);return e.put(ea.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Xu.store).os().next(function(n){t.deleteObjectStore(Xu.store),t.createObjectStore(Xu.store,{keyPath:Xu.keyPath,autoIncrement:!0}).createIndex(Xu.userMutationsIndex,Xu.userMutationsKeyPath,{unique:!0});var r=e.store(Xu.store),i=n.map(function(t){return r.put(t)});return ju.$n(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(ra.store,{keyPath:ra.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Hr(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Qu.store)}(t),i.Jr(o)})),n<7&&r>=7&&(s=s.next(function(){return i.Yr(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore($u.store);e.createIndex($u.readTimeIndex,$u.readTimeIndexPath,{unique:!1}),e.createIndex($u.collectionReadTimeIndex,$u.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Zr(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(ia.store,{keyPath:ia.keyPath})}(t),function(t){t.createObjectStore(oa.store,{keyPath:oa.keyPath})}(t)})),s},t.prototype.Jr=function(t){var e=0;return t.store($u.store).ls(function(t,n){e+=La(n)}).next(function(){var n=new Qu(e);return t.store(Qu.store).put(Qu.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(Ku.store),r=t.store(Xu.store);return n.os().next(function(n){return ju.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Xu.userMutationsIndex,i).next(function(r){return ju.forEach(r,function(r){Vr(r.userId===n.userId);var i=ba(e.Kt,r);return Ca(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(ta.store),n=t.store($u.store);return t.store(ea.store).get(ea.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new fi(n),s=function(t){return[0,qu(t)]}(o);r.push(e.get(s).next(function(n){return n?ju.resolve():function(n){return e.put(new ta(0,qu(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return ju.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(na.store,{keyPath:na.keyPath});var n=e.store(na.store),r=new ja,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:qu(i)})}};return e.store($u.store).ls({hs:!0},function(t,e){var n=new fi(t);return i(n.Z())}).next(function(){return e.store(Ju.store).ls({hs:!0},function(t,e){var n=Gu(t[1]);return i(n.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(Zu.store);return n.ls(function(t,r){var i=ma(r),o=wa(e.Kt,i);return n.put(o)})},t}();function ic(t){t.createObjectStore(ta.store,{keyPath:ta.keyPath}).createIndex(ta.documentTargetsIndex,ta.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Zu.store,{keyPath:Zu.keyPath}).createIndex(Zu.queryTargetsIndexName,Zu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ea.store)}var oc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=u,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.jn())throw new Xr(Kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new Ya(this,i),this.lo=n+"main",this.Kt=new fa(a),this._o=new Nu(this.lo,11,new rc(this.Kt)),this.fo=new za(this.Ii,this.Kt),this.Ti=new Sa,this.wo=function(t,e){return new Qa(t,e)}(this.Kt,this.Ti),this.Eo=new Oa,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&Cr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Xr(Kr.FAILED_PRECONDITION,oc);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.ji(e)})}).then(function(e){t.io=new ui(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Object(xr.b)(e,void 0,void 0,function(){return Object(xr.d)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return Object(xr.b)(e,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return Object(xr.b)(e,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ac(e).put(new ra(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(ku(e))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return uc(t).get(Bu.key).next(function(t){return ju.resolve(e.Co(t))})},t.prototype.xo=function(t){return ac(t).delete(this.clientId)},t.prototype.No=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(xr.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=aa(t,ra.store);return e.os().next(function(t){var n=r.Fo(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return ju.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)this.To.removeItem(this.ko(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?ju.resolve(!0):uc(t).get(Bu.key).next(function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new Xr(Kr.FAILED_PRECONDITION,oc);return!1}}return!(!e.networkEnabled||!e.inForeground)||ac(t).os().next(function(t){return void 0===e.Fo(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return Object(xr.b)(this,void 0,void 0,function(){var t=this;return Object(xr.d)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[Bu.store,ra.store],function(e){var n=new ua(e,ui.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ac(e).os().next(function(e){return t.Fo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return Ra.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.jo=function(){return this.Ti},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Dr("IndexedDbPersistence","Starting transaction:",t),this._o.runTransaction(t,"readonly"===e?"readonly":"readwrite",sa,function(o){return r=new ua(o,i.io?i.io.next():ui.U),"readwrite-primary"===e?i.po(r).next(function(t){return!!t||i.vo(r)}).next(function(e){if(!e)throw Cr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new Xr(Kr.FAILED_PRECONDITION,Vu);return n(r)}).next(function(t){return i.Do(r).next(function(){return t})}):i.Go(r).next(function(){return n(r)})}).then(function(t){return r.ps(),t})},t.prototype.Go=function(t){var e=this;return uc(t).get(Bu.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Xr(Kr.FAILED_PRECONDITION,oc)})},t.prototype.Do=function(t){var e=new Bu(this.clientId,this.allowTabSynchronization,Date.now());return uc(t).put(Bu.key,e)},t.jn=function(){return Nu.jn()},t.prototype.So=function(t){var e=this,n=uc(t);return n.get(Bu.key).next(function(t){return e.Co(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(Bu.key)):ju.resolve()})},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Cr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Cr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){Cr("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function uc(t){return aa(t,Bu.store)}function ac(t){return aa(t,ra.store)}function cc(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var hc=function(t,e){this.progress=t,this.zo=e},fc=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=Ts();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=Es();return i.forEach(function(t,e){e||(e=new Xi(t,ci.min())),o=o.Ht(t,e)}),o})},t.prototype.jr=function(t,e,n){return function(t){return di.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):_o(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new di(e)).next(function(t){var e=Ss();return t instanceof Ki&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=Ss();return this.Ti.Qs(t,i).next(function(s){return ju.forEach(s,function(s){var u=function(t,e){return new yo(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return o.ic(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=es(a,r.get(c),0,o.Ss);r=h instanceof Ki?r.Ht(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){xo(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=ks(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ss&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ki&&(c=c.Ht(t,e))}),c})},t}(),lc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=ks(),i=ks(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),pc=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(ci.min())?this.hc(t,e):this.uc.Zo(t,r).next(function(o){var s=i.lc(e,o);return(mo(e)||wo(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(Pr()<=j.a.DEBUG&&Dr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ao(e)),i.uc.jr(t,e,n).next(function(t){return s.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new Is(ko(t));return e.forEach(function(e,r){r instanceof Ki&&xo(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return Pr()<=j.a.DEBUG&&Dr("QueryEngine","Using full collection scan to execute query:",Ao(e)),this.uc.jr(t,e,ci.min())},t}(),dc=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new bs(zr),this.wc=new Pa(function(t){return $i(t)},Qi),this.Ec=ci.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new fc(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function vc(t,e,n,r){return new dc(t,e,n,r)}function yc(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(xr.d)(this,function(s){switch(s.label){case 0:return n=Mr(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Ho.bi(t).next(function(s){return o=s,r=n.persistence.Ko(e),i=new fc(n.Tc,r,n.persistence.jo()),r.bi(t)}).next(function(e){for(var n=[],r=[],s=ks(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i.Zo(t,s).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}})})}function gc(t,e){var n=Mr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Or({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=ju.resolve();return o.forEach(function(t){s=s.next(function(){return r.fi(e,t)}).next(function(e){var o=e,s=n.Fs.get(t);Vr(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Os)})}),s.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function bc(t){var e=Mr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function mc(t,e){var n=Mr(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return Vr(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.W()-t.Mt.W()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.fo.Ji(t,c))}}});var u=Es();if(e.Me.forEach(function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))}),s.push(wc(t,o,e.Me,r,void 0).next(function(t){u=t})),!r.isEqual(ci.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.Wi(t,t.vs,r)});s.push(a)}return ju.$n(s).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,u)})}).then(function(t){return n.dc=i,t})}function wc(t,e,n,r,i){var o=ks();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=Es();return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Xi&&s.version.isEqual(ci.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):Dr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function Ic(t,e){var n=Mr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function Oc(t,e){var n=Mr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?ju.resolve(r=i):n.fo.qi(t).next(function(i){return r=new Do(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function _c(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:r=Mr(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ii.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!ku(s=u.sent()))throw s;return Dr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}})})}function Ec(t,e,n){var r=Mr(t),i=ci.min(),o=ks();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Mr(t),i=r.wc.get(n);return void 0!==i?ju.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,To(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.jr(t,e,n?i:ci.min(),n?o:ks())}).next(function(t){return{documents:t,Pc:o}})})}function Tc(t,e){var n=Mr(t),r=Mr(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function jc(t){var e=Mr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Mr(t),i=Es(),o=da(n),s=ec(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:$u.readTimeIndex,range:u},function(t,e){var n=la(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:va(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo;return e.Ec=t.readTime,n})}function Sc(t){return Object(xr.b)(this,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){return[2,(e=Mr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=ec(t),n=ci.min();return e.ls({index:$u.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=va(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function Nc(t,e,n,r){return Object(xr.b)(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,p;return Object(xr.d)(this,function(d){switch(d.label){case 0:for(i=Mr(t),o=ks(),s=Es(),u=As(),a=0,c=n;a<c.length;a++)f=e.yc((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Wr:!0}),[4,Oc(i,function(t){return To(bo(fi.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return wc(t,l,s,ci.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i.fo.Xi(t,p.targetId).next(function(){return i.fo.nr(t,o,p.targetId)}).next(function(){return i.Ic.tc(t,e)})})})]}})})}function Ac(t,e,n){return void 0===n&&(n=ks()),Object(xr.b)(this,void 0,void 0,function(){var r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return[4,Oc(t,To(Ia(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Mr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Qs(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(Br.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next(function(){return i.fo.Xi(t,r.targetId)}).next(function(){return i.fo.nr(t,n,r.targetId)}).next(function(){return i.Eo.Bs(t,e)})})]}})})}var xc=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return ju.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Qs(n.createTime)}),ju.resolve()},t.prototype.$s=function(t,e){return ju.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:Ia(t.bundledQuery),readTime:Qs(t.readTime)}}(e)),ju.resolve()},t}(),kc=function(){function t(){this.Sc=new Is(Pc.Dc),this.Cc=new Is(Pc.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new Pc(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Oc(new Pc(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new di(new fi([])),r=new Pc(n,t),i=new Pc(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Oc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Oc(e)})},t.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new di(new fi([])),n=new Pc(e,t),r=new Pc(e,t+1),i=ks();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new Pc(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),Pc=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return di.J(t.key,e.key)||zr(t.$c,e.$c)},t.xc=function(t,e){return zr(t.$c,e.$c)||di.J(t.key,e.key)},t}(),Dc=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new Is(Pc.Dc)}return t.prototype.Ri=function(t){return ju.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++;var o=new ca(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new Pc(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return ju.resolve(o)},t.prototype.yi=function(t,e){return ju.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=this.Qc(e+1),r=n<0?0:n;return ju.resolve(this.Ho.length>r?this.Ho[r]:null)},t.prototype.pi=function(){return ju.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return ju.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new Pc(e,0),i=new Pc(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),ju.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new Is(zr);return e.forEach(function(t){var e=new Pc(t,0),i=new Pc(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),ju.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;di.Et(i)||(i=i.child(""));var o=new Pc(new di(i),0),s=new Is(zr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)},o),ju.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;Vr(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return ju.forEach(e.mutations,function(i){var o=new Pc(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new Pc(e,0),r=this.qc.Pe(n);return ju.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return ju.resolve()},t.prototype.jc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),Cc=function(){function t(t,e){this.Ti=t,this.Wc=e,this.docs=new bs(di.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return ju.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ts();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),ju.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=Ss(),i=new di(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.value,a=u.li,c=u.readTime;if(!e.path.st(s.key.path))break;c.u(n)<=0||a instanceof Ki&&xo(e,a)&&(r=r.Ht(a.key,a))}return ju.resolve(r)},t.prototype.Gc=function(t,e){return ju.forEach(this.docs,function(t){return e(t)})},t.prototype.Or=function(t){return new Lc(this)},t.prototype.Mr=function(t){return ju.resolve(this.size)},t}(),Lc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Object(xr.c)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),ju.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(Da),Rc=function(){function t(t){this.persistence=t,this.zc=new Pa(function(t){return $i(t)},Qi),this.lastRemoteSnapshotVersion=ci.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new kc,this.targetCount=0,this.Yc=Fa.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),ju.resolve()},t.prototype.Ki=function(t){return ju.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return ju.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),ju.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ju.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Fa(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,ju.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),ju.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,ju.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)}),ju.$n(o).next(function(){return i})},t.prototype.tr=function(t){return ju.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return ju.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),ju.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Oi(t,e))}),ju.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),ju.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return ju.resolve(n)},t.prototype.ki=function(t,e){return ju.resolve(this.Jc.ki(e))},t}(),Uc=function(){function t(t,e){var n=this;this.Xc={},this.io=new ui(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new Rc(this),this.Ti=new Ta,this.wo=function(t,e){return new Cc(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new fa(e),this.Eo=new xc(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.jo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new Dc(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Vc(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return ju.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),Vc=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Object(xr.c)(e,t),e}(Mu),Mc=function(){function t(t){this.persistence=t,this.sa=new kc,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Ur()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),ju.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),ju.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),ju.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return ju.forEach(this.oa,function(r){var i=di.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return ju.Bn([function(){return ju.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function qc(t,e){return"firestore_clients_"+t+"_"+e}function Fc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function zc(t,e){return"firestore_targets_"+t+"_"+e}var Gc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Xr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Cr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Hc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Xr(r.error.code,r.error.message)),i?new t(e,r.state,o):(Cr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Bc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ds(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ni(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Cr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Kc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Cr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Xc=function(){function t(){this.activeTargetIds=Ds()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Jc=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new bs(zr),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=qc(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new Xc),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.jn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(xr.d)(this,function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(qc(this.persistenceKey,r)))&&(o=Bc.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)this.Ea(c[a]);return this.Ia=[],this.window.addEventListener("unload",function(){return h.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(zc(this.persistenceKey,t));if(n){var r=Hc.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(zc(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.ja(t)},t.prototype.Wa=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Dr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void Cr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return Object(xr.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(xr.d)(this,function(u){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=ui.U;if(null!=t)try{var n=JSON.parse(t);Vr("number"==typeof n),e=n}catch(t){Cr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==ui.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new Gc(this.currentUser,t,e,n),i=Fc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Fa=function(t){var e=Fc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ja=function(t){this.storage.setItem(this.ga,JSON.stringify({clientId:this._a,onlineState:t}))},t.prototype.Ua=function(t,e,n){var r=zc(this.persistenceKey,t),i=new Hc(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return Bc.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Gc.aa(new ei(void 0!==n[2]?n[2]:null),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return Hc.aa(r,e)},t.prototype.ba=function(t){return Kc.aa(t)},t.prototype.Xa=function(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=Ds();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),Wc=function(){function t(){this.ru=new Xc,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Oa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new Xc,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.Wa=function(){},t}(),Yc=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),$c=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Qc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Zc=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),th=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Object(xr.c)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise(function(i,o){var s=new Ar;s.listenOnce(jr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Tr.NO_ERROR:var e=s.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Tr.TIMEOUT:Dr("Connection",'RPC "'+t+'" timed out'),o(new Xr(Kr.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:var n=s.getStatus();if(Dr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Kr).indexOf(e)>=0?e:Kr.UNKNOWN}(r.status);o(new Xr(u,r.message))}else o(new Xr(Kr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Xr(Kr.UNAVAILABLE,"Connection failed."));break;default:Ur()}}finally{Dr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new wr,i=Oe(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),Object(S.l)()||Object(S.n)()||Object(S.j)()||Object(S.k)()||Object(S.o)()||Object(S.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Dr("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new Zc({du:function(t){c?Dr("Connection","Not sending because WebChannel is closed:",t):(a||(Dr("Connection","Opening WebChannel transport."),u.open(),a=!0),Dr("Connection","WebChannel sending:",t),u.send(t))},wu:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,Nr.EventType.OPEN,function(){c||Dr("Connection","WebChannel transport opened.")}),f(u,Nr.EventType.CLOSE,function(){c||(c=!0,Dr("Connection","WebChannel transport closed"),h.Pu())}),f(u,Nr.EventType.ERROR,function(t){c||(c=!0,Lr("Connection","WebChannel transport errored:",t),h.Pu(new Xr(Kr.UNAVAILABLE,"The operation could not be completed")))}),f(u,Nr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Vr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Dr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=fs[t];if(void 0!==e)return gs(e)}(i),s=r.message;void 0===o&&(o=Kr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Pu(new Xr(o,s)),u.close()}else Dr("Connection","WebChannel received:",n),h.yu(n)}}),f(i,Sr.STAT_EVENT,function(t){10===t.stat?Dr("Connection","Detected buffering proxy"):11===t.stat&&Dr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Ru()},0),h},e}(function(){function t(t){this.gu=t,this.T=t.T,this.Vu=(t.ssl?"https":"http")+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);Dr("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(e){throw Lr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){return this.Vu+"/v1/"+e+":"+Qc[t]},t}());function eh(){return"undefined"!=typeof window?window:null}function nh(){return"undefined"!=typeof document?document:null}function rh(t){return new Js(t,!0)}var ih=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Fu},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),oh=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new ih(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===Kr.RESOURCE_EXHAUSTED?(Cr(e.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===Kr.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then(function(e){t.Wu===n&&t.rh(e)},function(n){e(function(){var e=new Xr(Kr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return Object(xr.b)(t,void 0,void 0,function(){return Object(xr.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.Wu===t?n():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),sh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Object(xr.c)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ur()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(Vr(void 0===e||"string"==typeof e),Br.fromBase64String(e||"")):(Vr(void 0===e||e instanceof Uint8Array),Br.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?Kr.UNKNOWN:gs(t.code);return new Xr(e,t.message||"")}(u);n=new Fs(r,i,o,s||null)}else if("documentChange"in e){i=nu(t,(r=e.documentChange).document.name),o=Qs(r.document.updateTime);var u=new zi({mapValue:{fields:r.document.fields}}),a=(s=new Ki(i,o,u,{}),r.targetIds||[]);n=new Ms(a,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=nu(t,(r=e.documentDelete).document),o=r.readTime?Qs(r.readTime):ci.min(),u=new Xi(i,o),n=new Ms([],s=r.removedTargetIds||[],u.key,u);else if("documentRemove"in e)i=nu(t,(r=e.documentRemove).document),n=new Ms([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Ur();var c=e.filter;i=new vs(r=c.count||0),n=new qs(o=c.targetId,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return ci.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ci.min():e.readTime?Qs(e.readTime):ci.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=ou(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=Zi(r)?{documents:fu(t,r)}:{query:lu(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Ys(t,e.resumeToken):e.Mt.u(ci.min())>0&&(n.readTime=Ws(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ur()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=ou(this.Kt),e.removeTarget=t,this.eh(e)},e}(oh),uh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(Vr(void 0!==e),t.map(function(t){return function(t,e){var n=Qs(t.updateTime?t.updateTime:e);n.isEqual(ci.min())&&(n=Qs(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Yo(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=Qs(t.commitTime);return this.listener.wh(n,e)}return Vr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=ou(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return cu(e.Kt,t)})};this.eh(n)},e}(oh),ah=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Object(xr.c)(e,t),e.prototype.mh=function(){if(this.Ih)throw new Xr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===Kr.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===Kr.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),ch=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(Cr(e),this.Ph=!1):Dr("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),hh=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return Object(xr.b)(o,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return mh(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(xr.b)(this,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return(e=Mr(t)).Oh.add(4),[4,lh(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,fh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new ch(n,r)};function fh(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n;return Object(xr.d)(this,function(r){switch(r.label){case 0:if(!mh(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function lh(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n;return Object(xr.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ph(t,e){var n=Mr(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),bh(n)?gh(n):Ch(n).Ju()&&vh(n,e))}function dh(t,e){var n=Mr(t),r=Ch(n);n.Nh.delete(e),r.Ju()&&yh(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():mh(n)&&n.Mh.set("Unknown"))}function vh(t,e){t.Lh.cn(e.targetId),Ch(t).hh(e)}function yh(t,e){t.Lh.cn(e),Ch(t).lh(e)}function gh(t){t.Lh=new Gs({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),Ch(t).start(),t.Mh.yh()}function bh(t){return mh(t)&&!Ch(t).Hu()&&t.Nh.size>0}function mh(t){return 0===Mr(t).Oh.size}function wh(t){t.Lh=void 0}function Ih(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){return t.Nh.forEach(function(e,n){vh(t,e)}),[2]})})}function Oh(t,e){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(n){return wh(t),bh(t)?(t.Mh.ph(e),gh(t)):t.Mh.set("Unknown"),[2]})})}function _h(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o;return Object(xr.d)(this,function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof Fs&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(xr.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Nh.has(o=i[r])?[4,t.Ch.$h(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Eh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ms?t.Lh.wn(e):e instanceof qs?t.Lh.yn(e):t.Lh.In(e),n.isEqual(ci.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,bc(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Fe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(Br.h,n.Mt)),yh(t,e);var r=new Do(n.target,e,1,n.sequenceNumber);vh(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Eh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Eh(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r=this;return Object(xr.d)(this,function(i){switch(i.label){case 0:if(!ku(e))throw e;return t.Oh.add(1),[4,lh(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return bc(t.Sh)}),t.fs.bo(function(){return Object(xr.b)(r,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,fh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Th(t,e){return e().catch(function(n){return Eh(t,n,e)})}function jh(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(xr.d)(this,function(s){switch(s.label){case 0:e=Mr(t),n=Lh(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return mh(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Ic(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=Lh(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Eh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Sh(e)&&Nh(e),[2]}})})}function Sh(t){return mh(t)&&!Lh(t).Hu()&&t.xh.length>0}function Nh(t){Lh(t).start()}function Ah(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){return Lh(t).Th(),[2]})})}function xh(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n,r;return Object(xr.d)(this,function(i){for(e=Lh(t),n=0,r=t.xh;n<r.length;n++)e.dh(r[n].mutations);return[2]})})}function kh(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return r=t.xh.shift(),i=ha.from(r,e,n),[4,Th(t,function(){return t.Ch.qh(i)})];case 1:return o.sent(),[4,jh(t)];case 2:return o.sent(),[2]}})})}function Ph(t,e){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(n){switch(n.label){case 0:return e&&Lh(t).fh?[4,function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r;return Object(xr.d)(this,function(i){switch(i.label){case 0:return ys(r=e.code)&&r!==Kr.ABORTED?(n=t.xh.shift(),Lh(t).Xu(),[4,Th(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,jh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Sh(t)&&Nh(t),[2]}})})}function Dh(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n;return Object(xr.d)(this,function(r){switch(r.label){case 0:return n=Mr(t),e?(n.Oh.delete(2),[4,fh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,lh(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Ch(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=Mr(t);return r.mh(),new sh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Ih.bind(null,t),Iu:Oh.bind(null,t),uh:_h.bind(null,t)}),t.Fh.push(function(n){return Object(xr.b)(e,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),bh(t)?gh(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),wh(t),e.label=3;case 3:return[2]}})})})),t.Qh}function Lh(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=Mr(t);return r.mh(),new uh(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Ah.bind(null,t),Iu:Ph.bind(null,t),Eh:xh.bind(null,t),wh:kh.bind(null,t)}),t.Fh.push(function(n){return Object(xr.b)(e,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,jh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(Dr("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var Rh=function(){this.jh=void 0,this.listeners=[]},Uh=function(){this.queries=new Pa(function(t){return No(t)},So),this.onlineState="Unknown",this.Wh=new Set};function Vh(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(xr.d)(this,function(c){switch(c.label){case 0:if(n=Mr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Rh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=c.sent(),[3,4];case 3:return u=c.sent(),a=Uu(u,"Initialization of query '"+Ao(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&zh(n),[2]}})})}function Mh(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(xr.d)(this,function(u){return n=Mr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function qh(t,e){for(var n=Mr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&zh(n)}function Fh(t,e,n){var r=Mr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function zh(t){t.Wh.forEach(function(t){t.next()})}var Gh=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Rs(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){return!t.fromCache||!(this.options.sl&&"Offline"!==e||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){return t.docChanges.length>0||!!(t.xe||this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=Rs.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),Hh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),Bh=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return nu(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?au(this.Kt,t.document,!1):new Xi(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Qs(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new Bh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||ks()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return[4,Nc(this.Sh,new Bh(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,Ac(this.Sh,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new hc(Object.assign({},this.progress),t))]}})})}}();var Kh=function(t){this.key=t},Xh=function(t){this.key=t},Jh=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=ks(),this.Ce=ks(),this.ll=ko(t),this._l=new Cs(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new Ls,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=mo(this.query)&&i.size===this.query.limit?i.last():null,c=wo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var h=i.get(t),f=e instanceof Ki?e:null;f&&(f=xo(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),mo(this.query)||wo(this.query))for(;s.size>this.query.limit;){var h=mo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ur()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new Rs(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new Ls,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=ks(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new Xh(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new Kh(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=ks();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return Rs.Oe(this.query,this._l,this.Ce,0===this.ul)},t}(),Wh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Yh=function(t){this.key=t,this.yl=!1},$h=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Pa(function(t){return No(t)},So),this.Dl=new Map,this.Cl=[],this.xl=new bs(di.J),this.Nl=new Map,this.Ol=new kc,this.Fl={},this.kl=new Map,this.Ml=Fa.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Qh(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:return n=Nf(t),(i=n.Sl.get(e))?(n.pl.ka(i.targetId),r=i.view.Pl(),[3,4]):[3,1];case 1:return[4,Oc(n.Sh,To(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),[4,Zh(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.$l&&ph(n.gl,o),u.label=4;case 4:return[2,r]}})})}function Zh(t,e,n,r){return Object(xr.b)(this,void 0,void 0,function(){var i,o,s,u,a,c;return Object(xr.d)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Object(xr.b)(this,void 0,void 0,function(){var i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,Ec(t.Sh,e.query,!1).then(function(t){return e.view.dl(t.documents,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(pf(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,Ec(t.Sh,e,!0)];case 1:return i=h.sent(),o=new Jh(e,i.Pc),s=o.dl(i.documents),u=Vs.Be(n,r&&"Offline"!==t.onlineState),a=o.Ei(s,t.$l,u),pf(t,n,a.ml),c=new Wh(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}})})}function tf(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return n=Mr(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter(function(t){return!So(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,_c(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),dh(n.gl,r.targetId),ff(n,r.targetId)}).catch(ka)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return ff(n,r.targetId),[4,_c(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function ef(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:r=Af(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Mr(t),i=ai.now(),o=e.reduce(function(t,e){return t.add(e.key)},ks());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=ns(c,n.get(c.key));null!=h&&s.push(new ss(c.key,h,Hi(h.proto.mapValue),$o.exists(!0)))}return r.Ho.Pi(t,i,s,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.R()];r||(r=new bs(zr)),r=r.Ht(e,n),t.Fl[t.currentUser.R()]=r}(r,i.batchId,n),[4,yf(r,i.oi)];case 3:return u.sent(),[4,jh(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Uu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function nf(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r;return Object(xr.d)(this,function(i){switch(i.label){case 0:n=Mr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,mc(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach(function(t,e){var r=n.Nl.get(e);r&&(Vr(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?Vr(r.yl):t.Ke.size>0&&(Vr(r.yl),r.yl=!1))}),[4,yf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ka(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function rf(t,e,n){var r=Mr(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Mr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&zh(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function of(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o,s,u,a;return Object(xr.d)(this,function(c){switch(c.label){case 0:return(r=Mr(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new bs(di.J)).Ht(o,new Xi(o,ci.min())),u=ks().add(o),a=new Us(ci.min(),new Map,new Is(zr),s,u),[4,nf(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),vf(r),[3,4];case 2:return[4,_c(r.Sh,e,!1).then(function(){return ff(r,e,n)}).catch(ka)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function sf(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:n=Mr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,gc(n.Sh,e)];case 2:return i=o.sent(),hf(n,r,null),cf(n,r),n.pl.Oa(r,"acknowledged"),[4,yf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ka(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function uf(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:r=Mr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Mr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return Vr(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Fi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return i=o.sent(),hf(r,e,n),cf(r,e),r.pl.Oa(e,"rejected",n),[4,yf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ka(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function af(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:mh((n=Mr(t)).gl)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Mr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=Uu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function cf(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function hf(t,e,n){var r=Mr(t),i=r.Fl[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i}}function ff(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach(function(e){t.Ol.ki(e)||lf(t,e)})}function lf(t,e){var n=t.xl.get(e);null!==n&&(dh(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),vf(t))}function pf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Kh?(t.Ol.sr(o.key,e),df(t,o)):o instanceof Xh?(Dr("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||lf(t,o.key)):Ur()}}function df(t,e){var n=e.key;t.xl.get(n)||(Dr("SyncEngine","New document in limbo: "+n),t.Cl.push(n),vf(t))}function vf(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Yh(e)),t.xl=t.xl.Ht(e,n),ph(t.gl,new Do(To(bo(e.path)),n,2,ui.U))}}function yf(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:return r=Mr(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,u){s.push(r.Bl(u,e,n).then(function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=lc.cc(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return Object(xr.d)(this,function(h){switch(h.label){case 0:n=Mr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return ju.forEach(e,function(e){return ju.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return ju.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!ku(r=h.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.dc.get(u),c=a.Bt(a.Mt),n.dc=n.dc.Ht(u,c));return[2]}})})}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function gf(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r;return Object(xr.d)(this,function(i){switch(i.label){case 0:return(n=Mr(t)).currentUser.isEqual(e)?[3,3]:(Dr("SyncEngine","User change. New user:",e.R()),[4,yc(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new Xr(Kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,yf(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function bf(t,e){var n=Mr(t),r=n.Nl.get(e);if(r&&r.yl)return ks().add(r.key);var i=ks(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Sl.get(u[s]);i=i.ye(a.view.fl)}return i}function mf(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return[4,Ec((n=Mr(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&pf(n,e.targetId,i.ml),i)]}})})}function wf(t){return Object(xr.b)(this,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){return[2,jc((e=Mr(t)).Sh).then(function(t){return yf(e,t)})]})})}function If(t,e,n,r){return Object(xr.b)(this,void 0,void 0,function(){var i,o;return Object(xr.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Mr(t),r=Mr(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):ju.resolve(null)})})}((i=Mr(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,jh(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(hf(i,e,r||null),cf(i,e),function(t,e){Mr(Mr(t).Ho).Ni(e)}(i.Sh,e)):Ur(),s.label=4;case 4:return[4,yf(i,o)];case 5:return s.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function Of(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return Object(xr.d)(this,function(c){switch(c.label){case 0:return Nf(n=Mr(t)),Af(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,_f(n,r.rt())]);case 1:return i=c.sent(),n.Ll=!0,[4,Dh(n.gl,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)ph(n.gl,s[o]);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],a=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?u.push(e):a=a.then(function(){return ff(n,e),_c(n.Sh,e,!0)}),dh(n.gl,e)}),[4,a]);case 4:return c.sent(),[4,_f(n,u)];case 5:return c.sent(),function(t){var e=Mr(t);e.Nl.forEach(function(t,n){dh(e.gl,n)}),e.Ol.Mc(),e.Nl=new Map,e.xl=new bs(di.J)}(n),n.Ll=!1,[4,Dh(n.gl,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function _f(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(xr.d)(this,function(v){switch(v.label){case 0:n=Mr(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Dl.get(u=s[o]))&&0!==c.length?[4,Oc(n.Sh,To(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Sl.get(f[h]),[4,mf(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Tc(n.Sh,u)];case 8:return d=v.sent(),[4,Oc(n.Sh,d)];case 9:return a=v.sent(),[4,Zh(n,Ef(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}})})}function Ef(t){return go(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Tf(t){var e=Mr(t);return Mr(Mr(e.Sh).persistence).Qo()}function jf(t,e,n,r){return Object(xr.b)(this,void 0,void 0,function(){var i,o,s;return Object(xr.d)(this,function(u){switch(u.label){case 0:return(i=Mr(t)).Ll?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,jc(i.Sh)];case 3:return o=u.sent(),s=Us.$e(e,"current"===n),[4,yf(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,_c(i.Sh,e,!0)];case 6:return u.sent(),ff(i,e,r),[3,8];case 7:Ur(),u.label=8;case 8:return[2]}})})}function Sf(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f;return Object(xr.d)(this,function(l){switch(l.label){case 0:if(!(r=Nf(t)).Ll)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Dl.has(s=o[i])?(Dr("SyncEngine","Adding an already active target "+s),[3,5]):[4,Tc(r.Sh,s)]:[3,6];case 2:return u=l.sent(),[4,Oc(r.Sh,u)];case 3:return a=l.sent(),[4,Zh(r,Ef(u),a.targetId,!1)];case 4:l.sent(),ph(r.gl,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(xr.d)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,_c(r.Sh,t,!1).then(function(){dh(r.gl,t),ff(r,t)}).catch(ka)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Nf(t){var e=Mr(t);return e.gl.Ch.Bh=nf.bind(null,e),e.gl.Ch.Sn=bf.bind(null,e),e.gl.Ch.$h=of.bind(null,e),e.vl.uh=qh.bind(null,e.Vl),e.vl.ql=Fh.bind(null,e.Vl),e}function Af(t){var e=Mr(t);return e.gl.Ch.qh=sf.bind(null,e),e.gl.Ch.Uh=uf.bind(null,e),e}var xf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return this.Kt=rh(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return vc(this.persistence,new pc,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new Uc(Mc.ra,this.Kt)},t.prototype.Wl=function(t){return new Wc},t.prototype.terminate=function(){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),kf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(xr.c)(e,t),e.prototype.initialize=function(e){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Sc(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Af(this.Xl.fa)];case 4:return n.sent(),[4,jh(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return vc(this.persistence,new pc,t.Yl,this.Kt)},e.prototype.Hl=function(t){return new Ja(this.persistence.Ii._r,t.fs)},e.prototype.Gl=function(t){var e=cc(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?xa.Xs(this.cacheSizeBytes):xa.ei;return new sc(this.synchronizeTabs,e,t.clientId,n,t.fs,eh(),nh(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new Wc},e}(xf),Pf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(xr.c)(e,t),e.prototype.initialize=function(e){return Object(xr.b)(this,void 0,void 0,function(){var n,r=this;return Object(xr.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof Jc?(this.pl.fa={nu:If.bind(null,n),su:jf.bind(null,n),iu:Sf.bind(null,n),Qo:Tf.bind(null,n),eu:wf.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po(function(t){return Object(xr.b)(r,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return[4,Of(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Wl=function(t){var e=eh();if(!Jc.jn(e))throw new Xr(Kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=cc(t.gu.T,t.gu.persistenceKey);return new Jc(e,t.fs,n,t.clientId,t.Yl)},e}(kf),Df=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n=this;return Object(xr.d)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return rf(n.fa,t,1)},this.gl.Ch.s_=gf.bind(null,this.fa),[4,Dh(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new Uh},t.prototype.Zl=function(t){var e=rh(t.gu.T),n=new th(t.gu);return function(t,e,n){return new ah(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return rf(s.fa,t,0)},o=$c.jn()?new $c:new Yc,new hh(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new $h(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Object(xr.b)(this,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return e=Mr(t),Dr("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,lh(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}(),Cf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Lf=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new Tu,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(xr.d)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new Hh(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return Object(xr.b)(this,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new pi(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),Rf=function(t){this._methodName=t};function Uf(t,e,n){if(!n)throw new Xr(Kr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Vf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Mf(t,e,n,r){if(!0===e&&!0===r)throw new Xr(Kr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function qf(t){if(!di.Et(t))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ff(t){if(di.Et(t))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function zf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ur()}function Gf(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new Xr(Kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=zf(t);throw new Xr(Kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Hf(t,e){if(e<=0)throw new Xr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Bf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Xr(Kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Xr(Kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Mf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Kf=new Map,Xf=function(){function t(t,e){this.w_="(lite)",this.E_=new Bf({}),this.T_=!1,t instanceof ti?(this.I_=t,this.m_=new ri):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Xr(Kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ti(t.options.projectId)}(t),this.m_=new ii(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new Xr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new Xr(Kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Bf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new ri;switch(t.type){case"gapi":var e=t.client;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new si(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Xr(Kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return(t=Kf.get(this))&&(Dr("ComponentProvider","Removing Datastore"),Kf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Jf=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Yf(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),Wf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Yf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,bo(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Jf(this.firestore,null,new di(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(Wf);function $f(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Wr&&(t=t._),Uf("collection","path",e),t instanceof Xf)return Ff(n=fi.ct.apply(fi,Object(xr.g)([e],r))),new Yf(t,null,n);if(!(t instanceof Jf||t instanceof Yf))throw new Xr(Kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ff(n=fi.ct.apply(fi,Object(xr.g)([t.path],r)).child(fi.ct(e))),new Yf(t.firestore,null,n)}function Qf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Wr&&(t=t._),1===arguments.length&&(e=Fr.t()),Uf("doc","path",e),t instanceof Xf)return qf(n=fi.ct.apply(fi,Object(xr.g)([e],r))),new Jf(t,null,new di(n));if(!(t instanceof Jf||t instanceof Yf))throw new Xr(Kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return qf(n=t.D_.child(fi.ct.apply(fi,Object(xr.g)([e],r)))),new Jf(t.firestore,t instanceof Yf?t.v_:null,new di(n))}function Zf(t,e){return t instanceof Wr&&(t=t._),e instanceof Wr&&(e=e._),(t instanceof Jf||t instanceof Yf)&&(e instanceof Jf||e instanceof Yf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function tl(t,e){return t instanceof Wr&&(t=t._),e instanceof Wr&&(e=e._),t instanceof Wf&&e instanceof Wf&&t.firestore===e.firestore&&So(t.C_,e.C_)&&t.v_===e.v_}var el=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Xr(Kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Xr(Kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return zr(this.x_,t.x_)||zr(this.N_,t.N_)},t}(),nl=/^__.*__$/,rl=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return null!==this.zt?new ss(t,this.data,this.zt,e,this.fieldTransforms):new os(t,this.data,e,this.fieldTransforms)},t}(),il=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return new ss(t,this.data,this.zt,e,this.fieldTransforms)},t}();function ol(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ur()}}var sl=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.F_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return jl(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(ol(this.k_)&&nl.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),ul=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||rh(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new sl({k_:t,methodName:e,W_:n,path:pi.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function al(t){var e=t.p_(),n=rh(t.I_);return new ul(t.I_,!!e.ignoreUndefinedProperties,n)}function cl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Ol("Data must be an object, but it was:",s,r);var u,a,c=wl(r,s);if(o.merge)u=new bi(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=_l(e,l[f],n);if(!s.contains(p))throw new Xr(Kr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Sl(h,p)||h.push(p)}u=new bi(h),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new rl(new zi(c),u,a)}var hl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw t.K_(1===t.k_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Rf);function fl(t,e,n){return new sl({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.z_=function(t){return new Wo(t.path,new Fo)},e.prototype.isEqual=function(t){return t instanceof e},e}(Rf),pl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(xr.c)(e,t),e.prototype.z_=function(t){var e=fl(this,t,!0),n=this.H_.map(function(t){return ml(t,e)}),r=new zo(n);return new Wo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Rf),dl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(xr.c)(e,t),e.prototype.z_=function(t){var e=fl(this,t,!0),n=this.H_.map(function(t){return ml(t,e)}),r=new Ho(n);return new Wo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Rf),vl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(xr.c)(e,t),e.prototype.z_=function(t){var e=new Ko(t.Kt,Ro(t.Kt,this.J_));return new Wo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Rf);function yl(t,e,n,r){var i=t.G_(1,e,n);Ol("Data must be an object, but it was:",i,r);var o=[],s=new Gi;yi(r,function(t,r){var u=Tl(e,t,n);r instanceof Wr&&(r=r._);var a=i.U_(u);if(r instanceof hl)o.push(u);else{var c=ml(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new bi(o);return new il(s.yt(),u,i.fieldTransforms)}function gl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[_l(e,r,n)],a=[i];if(o.length%2!=0)throw new Xr(Kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(_l(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Gi,l=u.length-1;l>=0;--l)if(!Sl(h,u[l])){var p=u[l],d=a[l];d instanceof Wr&&(d=d._);var v=s.U_(p);if(d instanceof hl)h.push(p);else{var y=ml(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new bi(h);return new il(f.yt(),g,s.fieldTransforms)}function bl(t,e,n,r){return void 0===r&&(r=!1),ml(n,t.G_(r?4:3,e))}function ml(t,e){if(t instanceof Wr&&(t=t._),Il(t))return Ol("Unsupported field value:",e,t),wl(t,e);if(t instanceof Rf)return function(t,e){if(!ol(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ml(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Wr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ro(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ai.fromDate(t);return{timestampValue:Ws(e.Kt,n)}}if(t instanceof ai)return n=new ai(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ws(e.Kt,n)};if(t instanceof el)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Jr)return{bytesValue:Ys(e.Kt,t.l)};if(t instanceof Jf){var r=t.firestore.I_;if(!r.isEqual(n=e.T))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Zs(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+zf(t))}(t,e)}function wl(t,e){var n={};return gi(t)?e.path&&e.path.length>0&&e.zt.push(e.path):yi(t,function(t,r){var i=ml(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Il(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ai||t instanceof el||t instanceof Jr||t instanceof Jf||t instanceof Rf)}function Ol(t,e,n){if(!Il(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=zf(n);throw e.K_("an object"===r?t+" a custom object":t+" "+r)}}function _l(t,e,n){if(e instanceof Wr&&(e=e._),e instanceof Lf)return e.d_;if("string"==typeof e)return Tl(t,e);throw jl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var El=new RegExp("[~\\*/\\[\\]]");function Tl(t,e,n){if(e.search(El)>=0)throw jl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Lf.bind.apply(Lf,Object(xr.g)([void 0],e.split("."))))).d_}catch(r){throw jl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function jl(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Xr(Kr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Sl(t,e){return t.some(function(t){return t.isEqual(e)})}var Nl=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n=this;return Object(xr.d)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new Xr(Kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i,o,s,u;return Object(xr.d)(this,function(a){switch(a.label){case 0:return n=Mr(t),r=ou(n.Kt)+"/documents",i={documents:e.map(function(t){return eu(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Vr(!!e.found);var n=nu(t,e.found.name),r=Qs(e.found.updateTime),i=new zi({mapValue:{fields:e.found.fields}});return new Ki(n,r,i,{})}(t,e):"missing"in e?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);var n=nu(t,e.missing),r=Qs(e.readTime);return new Xi(n,r)}(t,e):Ur()}(n.Kt,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Vr(!!e),u.push(e)}),u)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Xi||t instanceof Ki?n.sf(t):Ur()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new ps(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e=this;return Object(xr.d)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=di.ft(n);e.mutations.push(new ds(r,e.Gt(r)))}),[4,function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return n=Mr(t),r=ou(n.Kt)+"/documents",i={writes:e.map(function(t){return cu(n.Kt,t)})},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof Ki)e=t.version;else{if(!(t instanceof Xi))throw Ur();e=ci.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Xr(Kr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?$o.updateTime(e):$o.jt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(ci.min()))throw new Xr(Kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $o.updateTime(e)}return $o.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Al=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new ih(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return Object(xr.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(xr.d)(this,function(r){return t=new Nl(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ji(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ys(e)}return!1},t}(),xl=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=ei.UNAUTHENTICATED,this.clientId=Fr.t(),this._f=function(){},this.N=new Tu,this.credentials.S(function(t){Dr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new Xr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new Tu;return this.fs.Tf(function(){return Object(xr.b)(t,void 0,void 0,function(){var t,n;return Object(xr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Uu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function kl(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(xr.d)(this,function(o){switch(o.label){case 0:return t.fs.Af(),Dr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return Object(xr.b)(i,void 0,void 0,function(){return Object(xr.d)(this,function(t){switch(t.label){case 0:return[4,yc(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function Pl(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r;return Object(xr.d)(this,function(i){switch(i.label){case 0:return t.fs.Af(),[4,Dl(t)];case 1:return n=i.sent(),Dr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return Object(xr.b)(this,void 0,void 0,function(){var n,r;return Object(xr.d)(this,function(i){switch(i.label){case 0:return(n=Mr(t)).fs.Af(),Dr("RemoteStore","RemoteStore received new credentials"),r=mh(n),n.Oh.add(3),[4,lh(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,fh(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function Dl(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(Dr("FirestoreClient","Using default OfflineComponentProvider"),[4,kl(t,new xf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function Cl(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(Dr("FirestoreClient","Using default OnlineComponentProvider"),[4,Pl(t,new Df)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function Ll(t){return Dl(t).then(function(t){return t.persistence})}function Rl(t){return Dl(t).then(function(t){return t.Sh})}function Ul(t){return Cl(t).then(function(t){return t.gl})}function Vl(t){return Cl(t).then(function(t){return t.fa})}function Ml(t){return Object(xr.b)(this,void 0,void 0,function(){var e,n;return Object(xr.d)(this,function(r){switch(r.label){case 0:return[4,Cl(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Qh.bind(null,e.fa),n.Jh=tf.bind(null,e.fa),n)]}})})}function ql(t,e,n){var r=this;void 0===n&&(n={});var i=new Tu;return t.fs.ys(function(){return Object(xr.b)(r,void 0,void 0,function(){var r;return Object(xr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Cf({next:function(o){e.ys(function(){return Mh(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Xr(Kr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Xr(Kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Gh(bo(n.path),o,{includeMetadataChanges:!0,sl:!0});return Vh(t,s)},[4,Ml(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}function Fl(t,e,n){var r=this;void 0===n&&(n={});var i=new Tu;return t.fs.ys(function(){return Object(xr.b)(r,void 0,void 0,function(){var r;return Object(xr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Cf({next:function(n){e.ys(function(){return Mh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Xr(Kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Gh(n,o,{includeMetadataChanges:!0,sl:!0});return Vh(t,s)},[4,Ml(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}})})}),i.promise}var zl=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new ih(this,"async_queue_retry"),this.vf=function(){var e=nh();e&&Dr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=nh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=nh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return Object(xr.b)(this,void 0,void 0,function(){var t,e=this;return Object(xr.d)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!ku(t=n.sent()))throw t;return Dr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,Cr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Ru.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&Ur()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(xr.b)(this,void 0,void 0,function(){var t;return Object(xr.d)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Gl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new zl,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(xr.c)(e,t),e.prototype.b_=function(){return this.Lf||Bl(this),this.Lf.terminate()},e}(Xf);function Hl(t){return t.Lf||Bl(t),t.Lf.df(),t.Lf}function Bl(t){var e=t.p_(),n=function(t,e,n){return new Zr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new xl(t.m_,t.Mf,n)}function Kl(t,e,n){var r=this,i=new Tu;return t.fs.enqueue(function(){return Object(xr.b)(r,void 0,void 0,function(){var r;return Object(xr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,kl(t,n)];case 1:return o.sent(),[4,Pl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Kr.FAILED_PRECONDITION||t.code===Kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Xl(t){if(t.R_||t.P_)throw new Xr(Kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Jl=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Ai(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ii(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Oi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw Ur()}},t.prototype.Wf=function(t,e){var n=this,r={};return yi(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new el(Ii(t.latitude),Ii(t.longitude))},t.prototype.jf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=Ei(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Ti(t));default:return null}},t.prototype.Bf=function(t){var e=wi(t);return new ai(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=fi.ct(t);Vr(Eu(n));var r=new ti(n.get(1),n.get(3)),i=new di(n.X(5));return r.isEqual(e)||Cr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Wl=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Jf(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Yl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field($l("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Yl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Wl);function $l(t,e){return"string"==typeof e?Tl(t,e):e instanceof Wr?e._.d_:e.d_}function Ql(t){if(wo(t)&&0===t.Nt.length)throw new Xr(Kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zl=function(){};function tp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var ep=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Object(xr.c)(e,t),e.prototype.Yf=function(t){var e=al(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ap(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(up(r,t,h[c]));u={arrayValue:{values:a}}}else u=up(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ap(s,o),u=bl(n,"where",s,"in"===o||"not-in"===o);var f=to.create(i,o,u);return function(t,e){if(e.xt()){var n=Oo(t);if(null!==n&&!n.isEqual(e.field))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Io(t);null!==r&&cp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Xr(Kr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Wf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new yo(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Zl),np=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Object(xr.c)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new fo(e,n);return function(t,e){if(null===Io(t)){var n=Oo(t);null!==n&&cp(0,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new Wf(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new yo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Zl),rp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Object(xr.c)(e,t),e.prototype.Yf=function(t){return new Wf(t.firestore,t.v_,jo(t.C_,this.nd,this.sd))},e}(Zl),ip=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(xr.c)(e,t),e.prototype.Yf=function(t){var e=sp(t,this.type,this.rd,this.od);return new Wf(t.firestore,t.v_,function(t,e){return new yo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Zl),op=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Object(xr.c)(e,t),e.prototype.Yf=function(t){var e=sp(t,this.type,this.rd,this.od);return new Wf(t.firestore,t.v_,function(t,e){return new yo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Zl);function sp(t,e,n,r){if(n[0]instanceof Wr&&(n[0]=n[0]._),n[0]instanceof Wl)return function(t,e,n,r,i){if(!r)throw new Xr(Kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Eo(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(Ri(e,r.key));else{var c=r.field(a.field);if(_i(c))throw new Xr(Kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new co(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=al(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Xr(Kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!_o(t)&&-1!==c.indexOf("/"))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(fi.ct(c));if(!di.Et(h))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new di(h);u.push(Ri(e,f))}else{var l=bl(n,r,c);u.push(l)}}return new co(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function up(t,e,n){if(n instanceof Wr&&(n=n._),"string"==typeof n){if(""===n)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!_o(e)&&-1!==n.indexOf("/"))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(fi.ct(n));if(!di.Et(r))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ri(t,new di(r))}if(n instanceof Jf)return Ri(t,n.S_);throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zf(n)+".")}function ap(t,e){if(!Array.isArray(t)||0===t.length)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function cp(t,e,n){if(!n.isEqual(e))throw new Xr(Kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function hp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function fp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var lp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(xr.c)(e,t),e.prototype.Uf=function(t){return new Jr(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Jf(this.firestore,null,e)},e}(Jl),pp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),dp=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return Object(xr.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new vp(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field($l("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(Wl),vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(dp),yp=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new pp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new vp(n.zf,n.Hf,r.key,r,new pp(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new Xr(Kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){return{type:"added",doc:new vp(t.zf,t.Hf,e.doc.key,e.doc,new pp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new vp(t.zf,t.Hf,e.doc.key,e.doc,new pp(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:gp(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function gp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ur()}}function bp(t,e){return t instanceof dp&&e instanceof dp?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof yp&&e instanceof yp&&t.zf===e.zf&&tl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var mp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(xr.c)(e,t),e.prototype.Uf=function(t){return new Jr(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Jf(this.firestore,null,e)},e}(Jl);function wp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Gf(t,Jf);var o=Gf(t.firestore,Gl),s=al(o);return e instanceof Wr&&(e=e._),Op(o,[("string"==typeof e||e instanceof Lf?gl(s,"updateDoc",t.S_,e,n,r):yl(s,"updateDoc",t.S_,e)).O_(t.S_,$o.exists(!0))])}function Ip(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Wr&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||hp(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(hp(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Jf)c=Gf(t.firestore,Gl),h=bo(t.S_.path),a={next:function(e){i[u]&&i[u](_p(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Gf(t,Wf);c=Gf(p.firestore,Gl),h=p.C_;var d=new mp(c);a={next:function(t){i[u]&&i[u](new yp(c,d,p,t))},error:i[u+1],complete:i[u+2]},Ql(t.C_)}return function(t,e,n,r){var i=this,o=new Cf(r),s=new Gh(e,o,n);return t.fs.ys(function(){return Object(xr.b)(i,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return e=Vh,[4,Ml(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.r_(),t.fs.ys(function(){return Object(xr.b)(i,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return e=Mh,[4,Ml(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Hl(c),h,f,a)}function Op(t,e){return function(t,e){var n=this,r=new Tu;return t.fs.ys(function(){return Object(xr.b)(n,void 0,void 0,function(){var n;return Object(xr.d)(this,function(i){switch(i.label){case 0:return n=ef,[4,Vl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Hl(t),e)}function _p(t,e,n){var r=n.docs.get(e.S_),i=new mp(t);return new dp(t,i,e.S_,r,new pp(n.hasPendingWrites,n.fromCache),e.v_)}var Ep=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=al(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=Tp(t,this.zf),i=fp(r.v_,e,n),o=cl(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.O_(r.S_,$o.jt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=Tp(t,this.zf);return e instanceof Wr&&(e=e._),o="string"==typeof e||e instanceof Lf?gl(this.wd,"WriteBatch.update",s.S_,e,n,r):yl(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.O_(s.S_,$o.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=Tp(t,this.zf);return this.fd=this.fd.concat(new ps(e.S_,$o.jt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new Xr(Kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Tp(t,e){if(t instanceof Wr&&(t=t._),t.firestore!==e)throw new Xr(Kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var jp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Object(xr.c)(e,t),e.prototype.get=function(e){var n=this,r=Tp(e,this.zf),i=new mp(this.zf);return t.prototype.get.call(this,e).then(function(t){return new dp(n.zf,i,r.S_,t.Jf,new pp(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=al(t)}return t.prototype.get=function(t){var e=this,n=Tp(t,this.zf),r=new lp(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Ur();var i=t[0];if(i instanceof Xi)return new Wl(e.zf,r,n.S_,null,n.v_);if(i instanceof Ki)return new Wl(e.zf,r,i.key,i,n.v_);throw Ur()})},t.prototype.set=function(t,e,n){var r=Tp(t,this.zf),i=fp(r.v_,e,n),o=cl(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Tp(t,this.zf);return e instanceof Wr&&(e=e._),o="string"==typeof e||e instanceof Lf?gl(this.wd,"Transaction.update",s.S_,e,n,r):yl(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=Tp(t,this.zf);return this.Td.delete(e.S_),this},t}()),Sp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Xl(t=Gf(t,Gl));var n=Hl(t),r=t.p_(),i=new Df;return Kl(n,i,new kf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Xl(t=Gf(t,Gl));var e=Hl(t),n=t.p_(),r=new Df;return Kl(e,r,new Pf(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Xr(Kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Tu;return t.Mf.Tf(function(){return Object(xr.b)(e,void 0,void 0,function(){var e;return Object(xr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(xr.b)(this,void 0,void 0,function(){return Object(xr.d)(this,function(e){switch(e.label){case 0:return Nu.jn()?[4,Nu.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(cc(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),Np=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof ti||(i.md=e),i}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Gf(t,Xf)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&Lr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(xr.b)(e,void 0,void 0,function(){var e,n;return Object(xr.d)(this,function(r){switch(r.label){case 0:return[4,Ll(t)];case 1:return e=r.sent(),[4,Ul(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=Mr(t);return e.Oh.delete(0),fh(e)}(n))]}})})})}(Hl(Gf(this._,Gl)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return Object(xr.b)(e,void 0,void 0,function(){var e,n;return Object(xr.d)(this,function(r){switch(r.label){case 0:return[4,Ll(t)];case 1:return e=r.sent(),[4,Ul(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Object(xr.b)(this,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return(e=Mr(t)).Oh.add(0),[4,lh(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(Hl(Gf(this._,Gl)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Mf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Tu;return t.fs.ys(function(){return Object(xr.b)(e,void 0,void 0,function(){var e;return Object(xr.d)(this,function(r){switch(r.label){case 0:return e=af,[4,Vl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Hl(Gf(this._,Gl)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Cf(e);return t.fs.ys(function(){return Object(xr.b)(n,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Mr(t).Wh.add(e),e.next()},[4,Ml(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return Object(xr.b)(n,void 0,void 0,function(){var e;return Object(xr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Mr(t).Wh.delete(e)},[4,Ml(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Hl(t=Gf(t,Gl)),hp(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new Xr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Fp(this,$f(this._,t))}catch(t){throw Dp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Pp(this,Qf(this._,t))}catch(t){throw Dp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Vp(this,function(t,e){if(t=Gf(t,Xf),Uf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Wf(t,null,function(t){return new yo(fi.at(),t)}(e))}(this._,t))}catch(t){throw Dp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Tu;return t.fs.ys(function(){return Object(xr.b)(n,void 0,void 0,function(){var n;return Object(xr.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Cl(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new Al(t.fs,n,e,r).run(),[2]}})})}),r.promise}(Hl(t),function(n){return e(new jp(t,n))})}(this._,function(n){return t(new xp(e,n))})},e.prototype.batch=function(){var t=this;return Hl(this._),new kp(new Ep(this._,function(e){return Op(t._,e)}))},e.prototype.loadBundle=function(t){throw new Xr(Kr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Xr(Kr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Wr),Ap=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(xr.c)(e,t),e.prototype.Uf=function(t){return new Qr(new Jr(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return Pp.Ad(e,this.firestore,null)},e}(Jl),xp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new Ap(e),r}return Object(xr.c)(e,t),e.prototype.get=function(t){var e=this,n=zp(t);return this._.get(n).then(function(t){return new Rp(e.zf,new dp(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=zp(t);return n?(Vf("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=zp(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(xr.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=zp(t);return this._.delete(e),this},e}(Wr),kp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.set=function(t,e,n){var r=zp(t);return n?(Vf("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=zp(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Object(xr.g)([s,e,n],i)),this},e.prototype.delete=function(t){var e=zp(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(Wr),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Ap(e),r}return Object(xr.c)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new Xr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Jf(n._,r,new di(t)))},e.Ad=function(t,n,r){return new e(n,new Jf(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Fp(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Fp(this.firestore,$f(this._,t))}catch(t){throw Dp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Wr&&(t=t._),t instanceof Jf&&Zf(this._,t)},e.prototype.set=function(t,e){e=Vf("DocumentReference.set",e);try{return function(t,e,n){t=Gf(t,Jf);var r=Gf(t.firestore,Gl),i=fp(t.v_,e,n);return Op(r,[cl(al(r),"setDoc",t.S_,i,null!==t.v_,n).O_(t.S_,$o.jt())])}(this._,t,e)}catch(t){throw Dp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?wp(this._,t):wp.apply(void 0,Object(xr.g)([this._,t,e],n))}catch(t){throw Dp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Op(Gf((t=this._).firestore,Gl),[new ps(t.S_,$o.jt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Cp(e),i=Lp(e,function(e){return new Rp(t.firestore,new dp(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return Ip(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Gf(t,Jf);var e=Gf(t.firestore,Gl),n=Hl(e),r=new mp(e);return function(t,e){var n=this,r=new Tu;return t.fs.ys(function(){return Object(xr.b)(n,void 0,void 0,function(){var n;return Object(xr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i;return Object(xr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Mr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(i=o.sent())instanceof Ki?n.resolve(i):i instanceof Xi?n.resolve(null):n.reject(new Xr(Kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Uu(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Rl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new dp(e,r,t.S_,n,new pp(n instanceof Ki&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Gf(t,Jf);var e=Gf(t.firestore,Gl);return ql(Hl(e),t.S_,{source:"server"}).then(function(n){return _p(e,t,n)})}(this._):function(t){t=Gf(t,Jf);var e=Gf(t.firestore,Gl);return ql(Hl(e),t.S_).then(function(n){return _p(e,t,n)})}(this._)).then(function(t){return new Rp(e.firestore,new dp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Wr);function Dp(t,e,n){return t.message=t.message.replace(e,n),t}function Cp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!hp(r))return r}return{}}function Lp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=hp(t[0])?t[0]:hp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Rp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Pp(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return bp(this._,t._)},e}(Wr),Up=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(Rp),Vp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new Ap(e),r}return Object(xr.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,tp(this._,function(t,e,n){var r=e,i=$l("where",t);return new ep(i,r,n)}(t,n,r)))}catch(t){throw Dp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,tp(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=$l("orderBy",t);return new np(r,n)}(t,n)))}catch(t){throw Dp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,tp(this._,function(t){return Hf("limit",t),new rp("limit",t,"F")}(t)))}catch(t){throw Dp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,tp(this._,function(t){return Hf("limitToLast",t),new rp("limitToLast",t,"L")}(t)))}catch(t){throw Dp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,tp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw Dp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,tp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw Dp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,tp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw Dp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,tp(this._,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw Dp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return tl(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Gf(t,Wf);var e=Gf(t.firestore,Gl),n=Hl(e),r=new mp(e);return function(t,e){var n=this,r=new Tu;return t.fs.ys(function(){return Object(xr.b)(n,void 0,void 0,function(){var n;return Object(xr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(xr.b)(this,void 0,void 0,function(){var r,i,o,s,u;return Object(xr.d)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Ec(t,e,!0)];case 1:return u=a.sent(),r=new Jh(e,u.Pc),i=r.dl(u.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=Uu(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}})})},[4,Rl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new yp(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Gf(t,Wf);var e=Gf(t.firestore,Gl),n=Hl(e),r=new mp(e);return Fl(n,t.C_,{source:"server"}).then(function(n){return new yp(e,r,t,n)})}(this._):function(t){t=Gf(t,Wf);var e=Gf(t.firestore,Gl),n=Hl(e),r=new mp(e);return Ql(t.C_),Fl(n,t.C_).then(function(n){return new yp(e,r,t,n)})}(this._)).then(function(t){return new qp(e.firestore,new yp(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Cp(e),i=Lp(e,function(e){return new qp(t.firestore,new yp(t.firestore._,t.Hf,t._,e.ud))});return Ip(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Wr),Mp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Up(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(Wr),qp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Vp(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new Up(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Mp(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new Up(n.zf,r))})},e.prototype.isEqual=function(t){return bp(this._,t._)},e}(Wr),Fp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Object(xr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new Pp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Pp(this.firestore,void 0===t?Qf(this._):Qf(this._,t))}catch(t){throw Dp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Gf(t.firestore,Gl),r=Qf(t),i=fp(t.v_,e);return Op(n,[cl(al(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).O_(r.S_,$o.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new Pp(e.firestore,t)})},e.prototype.isEqual=function(t){return Zf(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Vp);function zp(t){return t instanceof Wr&&(t=t._),Gf(t,Jf)}var Gp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Lf.bind.apply(Lf,Object(xr.g)([void 0],e))))||this}return Object(xr.c)(e,t),e.documentId=function(){return new e(pi.lt().ot())},e.prototype.isEqual=function(t){return t instanceof Wr&&(t=t._),t instanceof Lf&&this._.d_.isEqual(t.d_)},e}(Wr),Hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(xr.c)(e,t),e.serverTimestamp=function(){var t=new ll("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new hl("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new pl("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dl("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new vl("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(Wr);!function(){function t(){this.Pd={},this.yd=new Tu,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var Bp,Kp=n("/6Yf"),Xp={Firestore:Np,GeoPoint:el,Timestamp:ai,Blob:Qr,Transaction:xp,WriteBatch:kp,DocumentReference:Pp,DocumentSnapshot:Rp,Query:Vp,QueryDocumentSnapshot:Up,QuerySnapshot:qp,CollectionReference:Fp,FieldPath:Gp,FieldValue:Hp,setLogLevel:function(t){kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Kp.a("firestore",function(t){return function(t,e){return new Np(t,new Gl(t,e),new Sp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Xp)))})(Bp=T.a),Bp.registerVersion("@firebase/firestore","2.1.2");var Jp=n("UbJi");function Wp(t,e){return function(t,e=c.b){return new h.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Yp(t,e){return Wp(t,e).pipe(Object(b.a)(t=>({payload:t,type:"query"})))}function $p(t,e){return Yp(t,e).pipe(Object(p.a)(void 0),v(),Object(b.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function Qp(t,e,n){return $p(t,n).pipe(Object(m.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return Zp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Zp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Zp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(w.a)(),Object(b.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Zp(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function td(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class ed{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=$p(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(b.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(p.a)(void 0),v(),Object(I.a)(([t,e])=>e.length>0||!t),Object(b.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(m.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=td(t);return Qp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Yp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(b.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(f.a)(this.query.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new nd(this.ref.doc(t),this.afs)}}class nd{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=ad(n,e);return new ed(r,i,this.afs)}snapshotChanges(){return Wp(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(void 0),v(),Object(b.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(b.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(f.a)(this.ref.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}}class rd{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?$p(this.query,this.afs.schedulers.outsideAngular).pipe(Object(b.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(I.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):$p(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(m.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=td(t);return Qp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Yp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(b.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(f.a)(this.query.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}}const id=new a.t("angularfire2.enableFirestorePersistence"),od=new a.t("angularfire2.firestore.persistenceSettings"),sd=new a.t("angularfire2.firestore.settings"),ud=new a.t("angularfire2.firestore.use-emulator");function ad(t,e=(t=>t)){return{query:e(t),ref:t}}let cd=(()=>{class t{constructor(t,e,n,i,o,s,u,a,c){this.schedulers=new _.d(s),this.keepUnstableUntilFirst=Object(_.h)(this.schedulers);const h=Object(_.g)(t,s,e);!E.a.auth&&c&&Object(_.j)();const p=a;[this.firestore,this.persistenceEnabled$]=Object(_.f)(h.name+".firestore","AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),p&&t.useEmulator(...p),n&&!Object(r.x)(o)){const e=()=>{try{return Object(f.a)(t.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(Bp){return"undefined"!=typeof console&&console.warn(Bp),Object(l.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(l.a)(!1)]},[i,p,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=ad(n,e),o=this.schedulers.ngZone.run(()=>r);return new ed(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new rd(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new nd(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(a.fc(_.c),a.fc(_.b,8),a.fc(id,8),a.fc(sd,8),a.fc(a.H),a.fc(a.E),a.fc(od,8),a.fc(ud,8),a.fc(Jp.c,8))},t.\u0275prov=Object(a.Ob)({factory:function(){return new t(Object(a.fc)(_.c),Object(a.fc)(_.b,8),Object(a.fc)(id,8),Object(a.fc)(sd,8),Object(a.fc)(a.H),Object(a.fc)(a.E),Object(a.fc)(od,8),Object(a.fc)(ud,8),Object(a.fc)(Jp.c,8))},token:t,providedIn:"any"}),t})(),hd=(()=>{class t{constructor(t){this.firestore=t}getProducto(){return this.firestore.collection("productos").snapshotChanges()}createProducto(t){return this.firestore.collection("productos").add(t)}updateProducto(t,e){return this.firestore.collection("productos").doc(t).update(e)}deleteProducto(t){return this.firestore.collection("productos").doc(t).delete()}}return t.\u0275fac=function(e){return new(e||t)(a.fc(cd))},t.\u0275prov=a.Ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function fd(t,e){if(1&t){var n=a.Yb();a.Xb(0,"a",11),a.ic("keyup.enter",function(){return a.zc(n),a.kc(3),a.yc(1).previous()})("click",function(){return a.zc(n),a.kc(3),a.yc(1).previous()}),a.Hc(1),a.Xb(2,"span",12),a.Hc(3),a.Wb(),a.Wb()}if(2&t){var r=a.kc(3);a.Hb("aria-label",r.previousLabel+" "+r.screenReaderPageLabel),a.Gb(1),a.Jc(" ",r.previousLabel," "),a.Gb(2),a.Ic(r.screenReaderPageLabel)}}function ld(t,e){if(1&t&&(a.Xb(0,"span"),a.Hc(1),a.Xb(2,"span",12),a.Hc(3),a.Wb(),a.Wb()),2&t){var n=a.kc(3);a.Gb(1),a.Jc(" ",n.previousLabel," "),a.Gb(2),a.Ic(n.screenReaderPageLabel)}}function pd(t,e){if(1&t&&(a.Xb(0,"li",8),a.Fc(1,fd,4,3,"a",9),a.Fc(2,ld,4,2,"span",10),a.Wb()),2&t){a.kc(2);var n=a.yc(1);a.Kb("disabled",n.isFirstPage()),a.Gb(1),a.qc("ngIf",1<n.getCurrent()),a.Gb(1),a.qc("ngIf",n.isFirstPage())}}function dd(t,e){if(1&t){var n=a.Yb();a.Xb(0,"a",11),a.ic("keyup.enter",function(){a.zc(n);var t=a.kc().$implicit;return a.kc(2),a.yc(1).setCurrent(t.value)})("click",function(){a.zc(n);var t=a.kc().$implicit;return a.kc(2),a.yc(1).setCurrent(t.value)}),a.Xb(1,"span",12),a.Hc(2),a.Wb(),a.Xb(3,"span"),a.Hc(4),a.lc(5,"number"),a.Wb(),a.Wb()}if(2&t){var r=a.kc().$implicit,i=a.kc(2);a.Gb(2),a.Jc("",i.screenReaderPageLabel," "),a.Gb(2),a.Ic("..."===r.label?r.label:a.nc(5,2,r.label,""))}}function vd(t,e){if(1&t&&(a.Vb(0),a.Xb(1,"span",12),a.Hc(2),a.Wb(),a.Xb(3,"span"),a.Hc(4),a.lc(5,"number"),a.Wb(),a.Ub()),2&t){var n=a.kc().$implicit,r=a.kc(2);a.Gb(2),a.Jc("",r.screenReaderCurrentLabel," "),a.Gb(2),a.Ic("..."===n.label?n.label:a.nc(5,2,n.label,""))}}function yd(t,e){if(1&t&&(a.Xb(0,"li"),a.Fc(1,dd,6,5,"a",9),a.Fc(2,vd,6,5,"ng-container",10),a.Wb()),2&t){var n=e.$implicit;a.kc(2);var r=a.yc(1);a.Kb("current",r.getCurrent()===n.value)("ellipsis","..."===n.label),a.Gb(1),a.qc("ngIf",r.getCurrent()!==n.value),a.Gb(1),a.qc("ngIf",r.getCurrent()===n.value)}}function gd(t,e){if(1&t){var n=a.Yb();a.Xb(0,"a",11),a.ic("keyup.enter",function(){return a.zc(n),a.kc(3),a.yc(1).next()})("click",function(){return a.zc(n),a.kc(3),a.yc(1).next()}),a.Hc(1),a.Xb(2,"span",12),a.Hc(3),a.Wb(),a.Wb()}if(2&t){var r=a.kc(3);a.Hb("aria-label",r.nextLabel+" "+r.screenReaderPageLabel),a.Gb(1),a.Jc(" ",r.nextLabel," "),a.Gb(2),a.Ic(r.screenReaderPageLabel)}}function bd(t,e){if(1&t&&(a.Xb(0,"span"),a.Hc(1),a.Xb(2,"span",12),a.Hc(3),a.Wb(),a.Wb()),2&t){var n=a.kc(3);a.Gb(1),a.Jc(" ",n.nextLabel," "),a.Gb(2),a.Ic(n.screenReaderPageLabel)}}function md(t,e){if(1&t&&(a.Xb(0,"li",13),a.Fc(1,gd,4,3,"a",9),a.Fc(2,bd,4,2,"span",10),a.Wb()),2&t){a.kc(2);var n=a.yc(1);a.Kb("disabled",n.isLastPage()),a.Gb(1),a.qc("ngIf",!n.isLastPage()),a.Gb(1),a.qc("ngIf",n.isLastPage())}}function wd(t,e){if(1&t&&(a.Xb(0,"ul",3),a.Fc(1,pd,3,4,"li",4),a.Xb(2,"li",5),a.Hc(3),a.Wb(),a.Fc(4,yd,3,6,"li",6),a.Fc(5,md,3,4,"li",7),a.Wb()),2&t){var n=a.kc(),r=a.yc(1);a.Kb("responsive",n.responsive),a.Hb("aria-label",n.screenReaderPaginationLabel),a.Gb(1),a.qc("ngIf",n.directionLinks),a.Gb(2),a.Kc(" ",r.getCurrent()," / ",r.getLastPage()," "),a.Gb(1),a.qc("ngForOf",r.pages),a.Gb(1),a.qc("ngIf",n.directionLinks)}}var Id=function(){function t(){this.change=new a.q,this.instances={},this.DEFAULT_ID="DEFAULT_PAGINATION_ID"}return t.prototype.defaultId=function(){return this.DEFAULT_ID},t.prototype.register=function(t){return null==t.id&&(t.id=this.DEFAULT_ID),this.instances[t.id]?this.updateInstance(t):(this.instances[t.id]=t,!0)},t.prototype.updateInstance=function(t){var e=!1;for(var n in this.instances[t.id])t[n]!==this.instances[t.id][n]&&(this.instances[t.id][n]=t[n],e=!0);return e},t.prototype.getCurrentPage=function(t){if(this.instances[t])return this.instances[t].currentPage},t.prototype.setCurrentPage=function(t,e){if(this.instances[t]){var n=this.instances[t];e<=Math.ceil(n.totalItems/n.itemsPerPage)&&1<=e&&(this.instances[t].currentPage=e,this.change.emit(t))}},t.prototype.setTotalItems=function(t,e){this.instances[t]&&0<=e&&(this.instances[t].totalItems=e,this.change.emit(t))},t.prototype.setItemsPerPage=function(t,e){this.instances[t]&&(this.instances[t].itemsPerPage=e,this.change.emit(t))},t.prototype.getInstance=function(t){return void 0===t&&(t=this.DEFAULT_ID),this.instances[t]?this.clone(this.instances[t]):{}},t.prototype.clone=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a.Ob({token:t,factory:function(e){return t.\u0275fac(e)}}),t}(),Od=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_d=Number.MAX_SAFE_INTEGER,Ed=(function(){function t(t){this.service=t,this.state={}}t.prototype.transform=function(t,e){if(!(t instanceof Array)){var n=e.id||this.service.defaultId();return this.state[n]?this.state[n].slice:t}var r,i,o=e.totalItems&&e.totalItems!==t.length,s=this.createInstance(t,e),u=s.id,a=s.itemsPerPage,c=this.service.register(s);if(!o&&t instanceof Array){if(this.stateIsIdentical(u,t,r=(s.currentPage-1)*(a=+a||_d),i=r+a))return this.state[u].slice;var h=t.slice(r,i);return this.saveState(u,t,h,r,i),this.service.change.emit(u),h}return c&&this.service.change.emit(u),this.saveState(u,t,t,r,i),t},t.prototype.createInstance=function(t,e){return this.checkConfig(e),{id:null!=e.id?e.id:this.service.defaultId(),itemsPerPage:+e.itemsPerPage||0,currentPage:+e.currentPage||1,totalItems:+e.totalItems||t.length}},t.prototype.checkConfig=function(t){var e=["itemsPerPage","currentPage"].filter(function(e){return!(e in t)});if(0<e.length)throw new Error("PaginatePipe: Argument is missing the following required properties: "+e.join(", "))},t.prototype.saveState=function(t,e,n,r,i){this.state[t]={collection:e,size:e.length,slice:n,start:r,end:i}},t.prototype.stateIsIdentical=function(t,e,n,r){var i=this.state[t];return!!i&&!(i.size!==e.length||i.start!==n||i.end!==r)&&i.slice.every(function(t,r){return t===e[n+r]})},(t=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}([Od("design:paramtypes",[Id])],t)).\u0275fac=function(e){return new(e||t)(a.Sb(Id))},t.\u0275pipe=a.Rb({name:"paginate",type:t,pure:!1})}(),function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}),Td=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};function jd(t){return!!t&&"false"!==t}var Sd=function(){function t(){this.maxSize=7,this.previousLabel="Previous",this.nextLabel="Next",this.screenReaderPaginationLabel="Pagination",this.screenReaderPageLabel="page",this.screenReaderCurrentLabel="You're on page",this.pageChange=new a.q,this.pageBoundsCorrection=new a.q,this._directionLinks=!0,this._autoHide=!1,this._responsive=!1}return Object.defineProperty(t.prototype,"directionLinks",{get:function(){return this._directionLinks},set:function(t){this._directionLinks=jd(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoHide",{get:function(){return this._autoHide},set:function(t){this._autoHide=jd(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"responsive",{get:function(){return this._responsive},set:function(t){this._responsive=jd(t)},enumerable:!0,configurable:!0}),Ed([Object(a.v)(),Td("design:type",String)],t.prototype,"id",void 0),Ed([Object(a.v)(),Td("design:type",Number)],t.prototype,"maxSize",void 0),Ed([Object(a.v)(),Td("design:type",Boolean),Td("design:paramtypes",[Boolean])],t.prototype,"directionLinks",null),Ed([Object(a.v)(),Td("design:type",Boolean),Td("design:paramtypes",[Boolean])],t.prototype,"autoHide",null),Ed([Object(a.v)(),Td("design:type",Boolean),Td("design:paramtypes",[Boolean])],t.prototype,"responsive",null),Ed([Object(a.v)(),Td("design:type",String)],t.prototype,"previousLabel",void 0),Ed([Object(a.v)(),Td("design:type",String)],t.prototype,"nextLabel",void 0),Ed([Object(a.v)(),Td("design:type",String)],t.prototype,"screenReaderPaginationLabel",void 0),Ed([Object(a.v)(),Td("design:type",String)],t.prototype,"screenReaderPageLabel",void 0),Ed([Object(a.v)(),Td("design:type",String)],t.prototype,"screenReaderCurrentLabel",void 0),Ed([Object(a.G)(),Td("design:type",a.q)],t.prototype,"pageChange",void 0),Ed([Object(a.G)(),Td("design:type",a.q)],t.prototype,"pageBoundsCorrection",void 0),t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Mb({type:t,selectors:[["pagination-controls"]],inputs:{maxSize:"maxSize",previousLabel:"previousLabel",nextLabel:"nextLabel",screenReaderPaginationLabel:"screenReaderPaginationLabel",screenReaderPageLabel:"screenReaderPageLabel",screenReaderCurrentLabel:"screenReaderCurrentLabel",directionLinks:"directionLinks",autoHide:"autoHide",responsive:"responsive",id:"id"},outputs:{pageChange:"pageChange",pageBoundsCorrection:"pageBoundsCorrection"},decls:3,vars:3,consts:[[3,"id","maxSize","pageChange","pageBoundsCorrection"],["p","paginationApi"],["class","ngx-pagination","role","navigation",3,"responsive",4,"ngIf"],["role","navigation",1,"ngx-pagination"],["class","pagination-previous",3,"disabled",4,"ngIf"],[1,"small-screen"],[3,"current","ellipsis",4,"ngFor","ngForOf"],["class","pagination-next",3,"disabled",4,"ngIf"],[1,"pagination-previous"],["tabindex","0",3,"keyup.enter","click",4,"ngIf"],[4,"ngIf"],["tabindex","0",3,"keyup.enter","click"],[1,"show-for-sr"],[1,"pagination-next"]],template:function(t,e){if(1&t&&(a.Xb(0,"pagination-template",0,1),a.ic("pageChange",function(t){return e.pageChange.emit(t)})("pageBoundsCorrection",function(t){return e.pageBoundsCorrection.emit(t)}),a.Fc(2,wd,6,8,"ul",2),a.Wb()),2&t){var n=a.yc(1);a.qc("id",e.id)("maxSize",e.maxSize),a.Gb(2),a.qc("ngIf",!(e.autoHide&&n.pages.length<=1))}},directives:function(){return[xd,r.l,r.k]},pipes:function(){return[r.e]},styles:["\n.ngx-pagination {\n  margin-left: 0;\n  margin-bottom: 1rem; }\n  .ngx-pagination::before, .ngx-pagination::after {\n    content: ' ';\n    display: table; }\n  .ngx-pagination::after {\n    clear: both; }\n  .ngx-pagination li {\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    margin-right: 0.0625rem;\n    border-radius: 0; }\n  .ngx-pagination li {\n    display: inline-block; }\n  .ngx-pagination a,\n  .ngx-pagination button {\n    color: #0a0a0a; \n    display: block;\n    padding: 0.1875rem 0.625rem;\n    border-radius: 0; }\n    .ngx-pagination a:hover,\n    .ngx-pagination button:hover {\n      background: #e6e6e6; }\n  .ngx-pagination .current {\n    padding: 0.1875rem 0.625rem;\n    background: #2199e8;\n    color: #fefefe;\n    cursor: default; }\n  .ngx-pagination .disabled {\n    padding: 0.1875rem 0.625rem;\n    color: #cacaca;\n    cursor: default; } \n    .ngx-pagination .disabled:hover {\n      background: transparent; }\n  .ngx-pagination a, .ngx-pagination button {\n    cursor: pointer; }\n\n.ngx-pagination .pagination-previous a::before,\n.ngx-pagination .pagination-previous.disabled::before { \n  content: '\xab';\n  display: inline-block;\n  margin-right: 0.5rem; }\n\n.ngx-pagination .pagination-next a::after,\n.ngx-pagination .pagination-next.disabled::after {\n  content: '\xbb';\n  display: inline-block;\n  margin-left: 0.5rem; }\n\n.ngx-pagination .show-for-sr {\n  position: absolute !important;\n  width: 1px;\n  height: 1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0); }\n.ngx-pagination .small-screen {\n  display: none; }\n@media screen and (max-width: 601px) {\n  .ngx-pagination.responsive .small-screen {\n    display: inline-block; } \n  .ngx-pagination.responsive li:not(.small-screen):not(.pagination-previous):not(.pagination-next) {\n    display: none; }\n}\n  "],encapsulation:2,changeDetection:0}),t}(),Nd=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Ad=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},xd=function(){function t(t,e){var n=this;this.service=t,this.changeDetectorRef=e,this.maxSize=7,this.pageChange=new a.q,this.pageBoundsCorrection=new a.q,this.pages=[],this.changeSub=this.service.change.subscribe(function(t){n.id===t&&(n.updatePageLinks(),n.changeDetectorRef.markForCheck(),n.changeDetectorRef.detectChanges())})}return t.prototype.ngOnInit=function(){void 0===this.id&&(this.id=this.service.defaultId()),this.updatePageLinks()},t.prototype.ngOnChanges=function(t){this.updatePageLinks()},t.prototype.ngOnDestroy=function(){this.changeSub.unsubscribe()},t.prototype.previous=function(){this.checkValidId(),this.setCurrent(this.getCurrent()-1)},t.prototype.next=function(){this.checkValidId(),this.setCurrent(this.getCurrent()+1)},t.prototype.isFirstPage=function(){return 1===this.getCurrent()},t.prototype.isLastPage=function(){return this.getLastPage()===this.getCurrent()},t.prototype.setCurrent=function(t){this.pageChange.emit(t)},t.prototype.getCurrent=function(){return this.service.getCurrentPage(this.id)},t.prototype.getLastPage=function(){var t=this.service.getInstance(this.id);return t.totalItems<1?1:Math.ceil(t.totalItems/t.itemsPerPage)},t.prototype.getTotalItems=function(){return this.service.getInstance(this.id).totalItems},t.prototype.checkValidId=function(){null==this.service.getInstance(this.id).id&&console.warn('PaginationControlsDirective: the specified id "'+this.id+'" does not match any registered PaginationInstance')},t.prototype.updatePageLinks=function(){var t=this,e=this.service.getInstance(this.id),n=this.outOfBoundCorrection(e);n!==e.currentPage?setTimeout(function(){t.pageBoundsCorrection.emit(n),t.pages=t.createPageArray(e.currentPage,e.itemsPerPage,e.totalItems,t.maxSize)}):this.pages=this.createPageArray(e.currentPage,e.itemsPerPage,e.totalItems,this.maxSize)},t.prototype.outOfBoundCorrection=function(t){var e=Math.ceil(t.totalItems/t.itemsPerPage);return e<t.currentPage&&0<e?e:t.currentPage<1?1:t.currentPage},t.prototype.createPageArray=function(t,e,n,r){r=+r;for(var i=[],o=Math.ceil(n/e),s=Math.ceil(r/2),u=t<=s,a=o-s<t,c=!u&&!a,h=r<o,f=1;f<=o&&f<=r;){var l=this.calculatePageNumber(f,t,r,o);i.push({label:h&&(2===f&&(c||a)||f===r-1&&(c||u))?"...":l,value:l}),f++}return i},t.prototype.calculatePageNumber=function(t,e,n,r){var i=Math.ceil(n/2);return t===n?r:1===t?t:n<r?r-i<e?r-n+t:i<e?e-i+t:t:t},Nd([Object(a.v)(),Ad("design:type",String)],t.prototype,"id",void 0),Nd([Object(a.v)(),Ad("design:type",Number)],t.prototype,"maxSize",void 0),Nd([Object(a.G)(),Ad("design:type",a.q)],t.prototype,"pageChange",void 0),Nd([Object(a.G)(),Ad("design:type",a.q)],t.prototype,"pageBoundsCorrection",void 0),(t=Nd([Ad("design:paramtypes",[Id,a.i])],t)).\u0275fac=function(e){return new(e||t)(a.Sb(Id),a.Sb(a.i))},t.\u0275dir=a.Nb({type:t,selectors:[["pagination-template"],["","pagination-template",""]],inputs:{maxSize:"maxSize",id:"id"},outputs:{pageChange:"pageChange",pageBoundsCorrection:"pageBoundsCorrection"},exportAs:["paginationApi"],features:[a.Eb]}),t}(),kd=function(){function t(){}return t.\u0275mod=a.Qb({type:t}),t.\u0275inj=a.Pb({factory:function(e){return new(e||t)},providers:[Id],imports:[[r.c]]}),t}();function Pd(t,e){if(1&t){const t=a.Yb();a.Xb(0,"tr"),a.Xb(1,"td"),a.Hc(2),a.Wb(),a.Xb(3,"td"),a.Hc(4),a.Wb(),a.Xb(5,"td"),a.Hc(6),a.Wb(),a.Xb(7,"td"),a.Xb(8,"button",6),a.ic("click",function(){a.zc(t);const n=e.$implicit,r=a.kc(),i=a.yc(20);return r.openEditar(i,n)}),a.Hc(9,"Editar"),a.Wb(),a.Xb(10,"button",7),a.ic("click",function(){a.zc(t);const n=e.$implicit;return a.kc().eliminar(n)}),a.Hc(11,"Eliminar"),a.Wb(),a.Wb(),a.Wb()}if(2&t){const t=e.$implicit;a.Gb(2),a.Ic(t.id),a.Gb(2),a.Ic(t.producto),a.Gb(2),a.Ic(t.descripcion)}}function Dd(t,e){if(1&t){const t=a.Yb();a.Xb(0,"button",20),a.ic("click",function(){return a.zc(t),a.kc(2).guardarProducto()}),a.Hc(1,"Guardar"),a.Wb()}}function Cd(t,e){if(1&t){const t=a.Yb();a.Xb(0,"button",20),a.ic("click",function(){return a.zc(t),a.kc(2).actualizarProducto()}),a.Hc(1,"Actualizar"),a.Wb()}}function Ld(t,e){if(1&t&&(a.Xb(0,"div",8),a.Xb(1,"h4",9),a.Hc(2,"Insertar producto "),a.Wb(),a.Xb(3,"button",10),a.ic("click",function(){return e.$implicit.dismiss("Cross click")}),a.Xb(4,"span",11),a.Hc(5,"\xd7"),a.Wb(),a.Wb(),a.Wb(),a.Xb(6,"div",12),a.Xb(7,"form"),a.Xb(8,"div",13),a.Xb(9,"form",14),a.Xb(10,"div",13),a.Xb(11,"label"),a.Hc(12,"Id"),a.Wb(),a.Tb(13,"input",15),a.Wb(),a.Xb(14,"div",13),a.Xb(15,"label"),a.Hc(16,"Producto"),a.Wb(),a.Tb(17,"input",16),a.Wb(),a.Xb(18,"div",13),a.Xb(19,"label"),a.Hc(20,"Descripcion"),a.Wb(),a.Tb(21,"input",17),a.Wb(),a.Wb(),a.Wb(),a.Wb(),a.Wb(),a.Xb(22,"div",18),a.Fc(23,Dd,2,0,"button",19),a.Fc(24,Cd,2,0,"button",19),a.Wb()),2&t){const t=a.kc();a.Gb(9),a.qc("formGroup",t.productoForm),a.Gb(14),a.qc("ngIf",!t.actualizar),a.Gb(1),a.qc("ngIf",t.actualizar)}}let Rd=(()=>{class t{constructor(t,e,n){this.modalService=t,this.fb=e,this.firebaseServiceService=n,this.closeResult="",this.collection={count:5,data:[]}}ngOnInit(){this.idFirebaseActualizar=" ",this.actualizar=!1,this.config={itemsPerPage:5,CurrentPage:1,totalItems:this.collection.count},this.productoForm=this.fb.group({id:["",s.p.required],producto:["",s.p.required],descripcion:["",s.p.required]}),this.firebaseServiceService.getProducto().subscribe(t=>{this.collection.data=t.map(t=>({id:t.payload.doc.data().id,producto:t.payload.doc.data().producto,descripcion:t.payload.doc.data().descripcion,idFirebase:t.payload.doc.id}))},t=>{console.error(t)})}pageChanged(t){this.config.currentPage=t}eliminar(t){this.firebaseServiceService.deleteProducto(t.idFirebase)}guardarProducto(){this.firebaseServiceService.createProducto(this.productoForm.value).then(t=>{this.productoForm.reset(),this.modalService.dismissAll()}).catch(t=>{console.error(t)})}actualizarProducto(){Object(u.isNullOrUndefined)(this.idFirebaseActualizar)||this.firebaseServiceService.updateProducto(this.idFirebaseActualizar,this.productoForm.value).then(t=>{this.productoForm.reset(),this.modalService.dismissAll()}).catch(t=>{console.error(t)})}openEditar(t,e){this.productoForm.setValue({id:e.id,producto:e.producto,descripcion:e.descripcion}),this.idFirebaseActualizar=e.idFirebase,this.actualizar=!0,this.modalService.open(t,{ariaLabelledBy:"modal-basic-title"}).result.then(t=>{this.closeResult="Closed with: "+t},t=>{this.closeResult="Dismissed "+this.getDismissReason(t)})}open(t){this.actualizar=!1,this.modalService.open(t,{ariaLabelledBy:"modal-basic-title"}).result.then(t=>{this.closeResult="Closed with: "+t},t=>{this.closeResult="Dismissed "+this.getDismissReason(t)})}getDismissReason(t){return t===o.a.ESC?"by pressing ESC":t===o.a.BACKDROP_CLICK?"by clicking on a backdrop":"with: "+t}}return t.\u0275fac=function(e){return new(e||t)(a.Sb(o.b),a.Sb(s.b),a.Sb(hd))},t.\u0275cmp=a.Mb({type:t,selectors:[["app-farm"]],decls:21,vars:1,consts:[[2,"text-align","center"],["type","button",1,"btn","btn-outline-success",3,"click"],[1,"table"],[4,"ngFor","ngForOf"],[3,"pageChange"],["content",""],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],[3,"formGroup"],["type","Number","formControlName","id",1,"form-control"],["type","Text","formControlName","producto",1,"form-control"],["type","Text","formControlName","descripcion",1,"form-control"],[1,"modal-footer"],["type","button","class","btn btn-outline-dark",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(t,e){if(1&t){const t=a.Yb();a.Xb(0,"div",0),a.Xb(1,"h2"),a.Hc(2,"Sistema de Farmacia"),a.Wb(),a.Xb(3,"button",1),a.ic("click",function(){a.zc(t);const n=a.yc(20);return e.open(n)}),a.Hc(4,"Insertar Producto"),a.Wb(),a.Xb(5,"table",2),a.Xb(6,"thead"),a.Xb(7,"tr"),a.Xb(8,"th"),a.Hc(9,"ID"),a.Wb(),a.Xb(10,"th"),a.Hc(11,"Producto"),a.Wb(),a.Xb(12,"th"),a.Hc(13,"Descripcion"),a.Wb(),a.Xb(14,"th"),a.Hc(15,"Opciones"),a.Wb(),a.Wb(),a.Wb(),a.Xb(16,"tbody"),a.Fc(17,Pd,12,3,"tr",3),a.Wb(),a.Wb(),a.Xb(18,"pagination-controls",4),a.ic("pageChange",function(t){return e.pageChanged(t)}),a.Wb(),a.Fc(19,Ld,25,3,"ng-template",null,5,a.Gc),a.Wb()}2&t&&(a.Gb(17),a.qc("ngForOf",e.collection.data))},directives:[r.k,Sd,s.r,s.k,s.l,s.f,s.n,s.a,s.j,s.d,r.l],styles:[""]}),t})();const Ud=[{path:"",component:Rd}];let Vd=(()=>{class t{}return t.\u0275mod=a.Qb({type:t}),t.\u0275inj=a.Pb({factory:function(e){return new(e||t)},imports:[[i.c.forChild(Ud)],i.c]}),t})();var Md=n("AytR");let qd=(()=>{class t{}return t.\u0275mod=a.Qb({type:t,bootstrap:[Rd]}),t.\u0275inj=a.Pb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c,Vd,kd,o.c,s.o,s.g,_.a.initializeApp(Md.a.firebaseConfig)]]}),t})()},KKCa:function(t,e){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},MCLT:function(t,e,n){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];n<o;a=r[++n])v(a)||!w(a)?s+=" "+a:s+=" "+u(a);return s},e.deprecate=function(t,n){if("undefined"!=typeof process&&!0===process.noDeprecation)return t;if("undefined"==typeof process)return function(){return e.deprecate(t,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),r=!0}return t.apply(this,arguments)}};var o,s={};function u(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),h(r,t,r.depth)}function a(t,e){var n=u.styles[e];return n?"\x1b["+u.colors[n][0]+"m"+t+"\x1b["+u.colors[n][1]+"m":t}function c(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&_(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return g(i)||(i=h(t,i,r)),i}var o=function(t,e){if(b(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}(t,n);if(o)return o;var s=Object.keys(n),u=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),O(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(_(n))return t.stylize("[Function"+(n.name?": "+n.name:"")+"]","special");if(m(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(I(n))return t.stylize(Date.prototype.toString.call(n),"date");if(O(n))return f(n)}var a,c="",w=!1,E=["{","}"];return p(n)&&(w=!0,E=["[","]"]),_(n)&&(c=" [Function"+(n.name?": "+n.name:"")+"]"),m(n)&&(c=" "+RegExp.prototype.toString.call(n)),I(n)&&(c=" "+Date.prototype.toUTCString.call(n)),O(n)&&(c=" "+f(n)),0!==s.length||w&&0!=n.length?r<0?m(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),a=w?function(t,e,n,r,i){for(var o=[],s=0,u=e.length;s<u;++s)N(e,String(s))?o.push(l(t,e,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(l(t,e,n,r,i,!0))}),o}(t,n,r,u,s):s.map(function(e){return l(t,n,r,u,e,w)}),t.seen.pop(),function(t,e,n){return t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(a,c,E)):E[0]+c+E[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,i,o){var s,u,a;if((a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=t.stylize(a.set?"[Getter/Setter]":"[Getter]","special"):a.set&&(u=t.stylize("[Setter]","special")),N(r,i)||(s="["+i+"]"),u||(t.seen.indexOf(a.value)<0?(u=v(n)?h(t,a.value,null):h(t,a.value,n-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return"number"==typeof t}function g(t){return"string"==typeof t}function b(t){return void 0===t}function m(t){return w(t)&&"[object RegExp]"===E(t)}function w(t){return"object"==typeof t&&null!==t}function I(t){return w(t)&&"[object Date]"===E(t)}function O(t){return w(t)&&("[object Error]"===E(t)||t instanceof Error)}function _(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function T(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(b(o)&&(o=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=process.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=b,e.isRegExp=m,e.isObject=w,e.isDate=I,e.isError=O,e.isFunction=_,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n("1gqn");var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),j[t.getMonth()],e].join(" ")}function N(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",S(),e.format.apply(e,arguments))},e.inherits=n("KKCa"),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function x(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(A&&t[A]){var e;if("function"!=typeof(e=t[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,A,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise(function(t,r){e=t,n=r}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(t,r){t?n(t):e(r)});try{t.apply(this,i)}catch(s){n(s)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),A&&Object.defineProperty(e,A,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=A,e.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function e(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);var r=e.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return r.apply(i,arguments)};t.apply(this,e).then(function(t){process.nextTick(o,null,t)},function(t){process.nextTick(x,t,o)})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,r(t)),e}}}]);